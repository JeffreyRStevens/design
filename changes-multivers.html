<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>29 Work with multiple dependency versions | Tidyverse design guide</title>
<meta name="author" content="Tidyverse team">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="29 Work with multiple dependency versions | Tidyverse design guide">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="29 Work with multiple dependency versions | Tidyverse design guide">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-115082821-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="29.1 What’s the pattern? In an ideal world, when a dependency of your package changes its interface, you want your package to work with both versions. This is more work but it has two significant...">
<meta property="og:description" content="29.1 What’s the pattern? In an ideal world, when a dependency of your package changes its interface, you want your package to work with both versions. This is more work but it has two significant...">
<meta name="twitter:description" content="29.1 What’s the pattern? In an ideal world, when a dependency of your package changes its interface, you want your package to work with both versions. This is more work but it has two significant...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Tidyverse design guide</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="structure.html"><span class="header-section-number">1</span> Structure</a></li>
<li><a class="" href="unifying-principles.html"><span class="header-section-number">2</span> Unifying principles</a></li>
<li class="book-part">Implementation</li>
<li><a class="" href="names-attribute.html"><span class="header-section-number">3</span> Names attribute</a></li>
<li><a class="" href="call-data-details.html"><span class="header-section-number">4</span> Name details arguments</a></li>
<li><a class="" href="function-names.html"><span class="header-section-number">5</span> Function names</a></li>
<li class="book-part">Interface: inputs</li>
<li><a class="" href="args-hidden.html"><span class="header-section-number">6</span> Avoid hidden arguments</a></li>
<li><a class="" href="args-data-details.html"><span class="header-section-number">7</span> Data, descriptors, details</a></li>
<li><a class="" href="args-independence.html"><span class="header-section-number">8</span> Avoid dependencies between arguments</a></li>
<li><a class="" href="case-study-setnames.html"><span class="header-section-number">9</span> Case study: setNames()</a></li>
<li class="book-part">Interface: default values</li>
<li><a class="" href="def-required.html"><span class="header-section-number">10</span> Required args shouldn’t have defaults</a></li>
<li><a class="" href="cs-rep.html"><span class="header-section-number">11</span> Case study: rep()</a></li>
<li><a class="" href="def-enum.html"><span class="header-section-number">12</span> Enumerate possible options</a></li>
<li><a class="" href="def-magical.html"><span class="header-section-number">13</span> Avoid magical defaults</a></li>
<li><a class="" href="def-short.html"><span class="header-section-number">14</span> Keep defaults short and sweet</a></li>
<li><a class="" href="def-inform.html"><span class="header-section-number">15</span> Explain important defaults</a></li>
<li><a class="" href="def-user.html"><span class="header-section-number">16</span> User settable defaults</a></li>
<li><a class="" href="cs-rgb.html"><span class="header-section-number">17</span> Case study: rgb()</a></li>
<li class="book-part">Interface: ...</li>
<li><a class="" href="dots-position.html"><span class="header-section-number">18</span> Data, dots, details</a></li>
<li><a class="" href="dots-data.html"><span class="header-section-number">19</span> Making data with …</a></li>
<li><a class="" href="dots-prefix.html"><span class="header-section-number">20</span> Dot prefix</a></li>
<li><a class="" href="dots-inspect.html"><span class="header-section-number">21</span> Inspect the dots</a></li>
<li><a class="" href="cs-mapply-pmap.html"><span class="header-section-number">22</span> Case study: mapply() vs pmap()</a></li>
<li class="book-part">Interface: outputs</li>
<li><a class="" href="out-multi.html"><span class="header-section-number">23</span> Returning multiple values</a></li>
<li><a class="" href="out-type-stability.html"><span class="header-section-number">24</span> Type-stability</a></li>
<li><a class="" href="out-vectorisation.html"><span class="header-section-number">25</span> Vectorisation</a></li>
<li><a class="" href="out-invisible.html"><span class="header-section-number">26</span> Side-effect functions should return invisibly</a></li>
<li class="book-part">Interface: errors</li>
<li><a class="" href="err-call.html"><span class="header-section-number">27</span> Error call</a></li>
<li><a class="" href="err-constructor.html"><span class="header-section-number">28</span> Error constructors</a></li>
<li class="book-part">Interface: changes</li>
<li><a class="active" href="changes-multivers.html"><span class="header-section-number">29</span> Work with multiple dependency versions</a></li>
<li class="book-part">Interface: side effects</li>
<li><a class="" href="side-effect-soup.html"><span class="header-section-number">30</span> Side-effect soup</a></li>
<li><a class="" href="spooky-action.html"><span class="header-section-number">31</span> Spooky action</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="glossary.html"><span class="header-section-number">A</span> Glossary</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="http://github.com/tidyverse/design">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="changes-multivers" class="section level1" number="29">
<h1>
<span class="header-section-number">29</span> Work with multiple dependency versions<a class="anchor" aria-label="anchor" href="#changes-multivers"><i class="fas fa-link"></i></a>
</h1>
<div id="whats-the-pattern-11" class="section level2" number="29.1">
<h2>
<span class="header-section-number">29.1</span> What’s the pattern?<a class="anchor" aria-label="anchor" href="#whats-the-pattern-11"><i class="fas fa-link"></i></a>
</h2>
<p>In an ideal world, when a dependency of your package changes its interface, you want your package to work with both versions. This is more work but it has two significant advantages:</p>
<ul>
<li><p>The CRAN submission process is decoupled. If your package only works with the
development version of a dependency, you’ll need to carefully coordinate your
CRAN submission with the dependencies CRAN submission. If your package works
with both versions, you can submit first, making life easier for CRAN and for
the maintainer of the dependency.</p></li>
<li><p>User code is less likely to be affected. If your package only works with the
latest version of the dependency, then when a user upgrades your package, the
dependency also must update. Upgrading multiple packages is more likely to
affect user code than updating a single package.</p></li>
</ul>
<p>In this pattern, you’ll learn how to write code designed to work with multiple versions of a dependency, and you’ll how to adapt your existing Travis configuration to test that you’ve got it right.</p>
</div>
<div id="writing-code" class="section level2" number="29.2">
<h2>
<span class="header-section-number">29.2</span> Writing code<a class="anchor" aria-label="anchor" href="#writing-code"><i class="fas fa-link"></i></a>
</h2>
<p>Sometimes there will be an easy way to change the code to work with both old and new versions of the package; do this if you can! However, in most cases, you can’t, and you’ll need an <code>if</code> statement that runs different code for new and old versions of the package:</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">dependency_has_new_interface</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># freshly written code that works with in-development dependency</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="co"># existing code that works with the currently released dependency</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>(If your freshly written code uses functions that don’t exist in the CRAN version this will generate an R CMD check <code>NOTE</code> when you submit it to CRAN. This is one of the few NOTEs that you can explain: just mention that it’s needed for forward/backward compatibility in your submission notes.)</p>
<p>We recommend always pulling out the check out into a function so that the logic lives in one place. This will make it much easier to pull it out when it’s no longer needed, and provides a good place to document why it’s needed.</p>
<p>There are three basic approaches to implement <code>dependency_has_new_interface()</code>:</p>
<ul>
<li><p>Check the version of the package. This is recommended in most cases,
but requires that the dependency author use a specific version convention.</p></li>
<li><p>Check for existence of a function.</p></li>
<li><p>Check for a specific argument value, or otherwise detect that the interface
has changed.</p></li>
</ul>
<div id="case-study-tidyr" class="section level3" number="29.2.1">
<h3>
<span class="header-section-number">29.2.1</span> Case study: tidyr<a class="anchor" aria-label="anchor" href="#case-study-tidyr"><i class="fas fa-link"></i></a>
</h3>
<p>To make the problem concrete so we can show of some real code, lets imagine we have a package that uses <code><a href="https://tidyr.tidyverse.org/reference/nest.html">tidyr::nest()</a></code>. <code><a href="https://tidyr.tidyverse.org/reference/nest.html">tidyr::nest()</a></code> changed substantially between 0.8.3 and 1.0.0, and so we need to write code like this:</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">tidyr_new_interface</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest_legacy.html">nest_legacy</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>(As described above, when submitted to CRAN this will generate a note about missing <code><a href="https://tidyr.tidyverse.org/reference/nest_legacy.html">tidyr::nest_legacy()</a></code> which can be explained in the submission comments.)</p>
<p>To implement <code>tidyr_new_interface()</code>, we need to think about three versions of tidyr:</p>
<ul>
<li><p>0.8.3: the version currently on CRAN with the old interface.</p></li>
<li><p>0.8.99.9000: the development version with the new interface. As usualy,
the fourth component is &gt;= 9000 to indicate that it’s a development
version. Note, however, that the patch version is 99; this indicates that
release includes breaking changes.</p></li>
<li><p>1.0.0: the future CRAN version; this is the version that will be submitted
to CRAN.</p></li>
</ul>
<p>The main question is how to write <code>tidyr_new_interface()</code>. There are three options:</p>
<ul>
<li>
<p>Check that the version is greater than the development version:</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidyr_new_interface</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="st">"0.8.99"</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This technique works because tidyr uses the convention that the
development version of backward incompatible functions contain <code>99</code>
in the third (patch) component.</p>
</li>
<li>
<p>If tidyr didn’t adopt this naming convention, we could test for the
existence of <code>unnest_legacy()</code>.</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidyr_new_interface1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="st">"unnest_legacy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ns-internal.html">asNamespace</a></span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</li>
<li>
<p>If the inteface change was more subtle, you might have to think more
creatively. If the package uses the <a href="http://lifecycle.r-lib.org/">lifecycle</a>
system, one approach would be to test for the presence of <code>deprecated()</code>
in the function arguments:</p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidyr_new_interface2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/formals.html">formals</a></span><span class="op">(</span><span class="fu">tidyr</span><span class="fu">::</span><span class="va"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">)</span><span class="op">$</span><span class="va">.key</span>, <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</li>
</ul>
<p>All these approaches are reaosnably fast, so it’s unlikely they’ll have any impact on performance unless called in a very tight loop.</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/mark.html">mark</a></span><span class="op">(</span></span>
<span>  version <span class="op">=</span> <span class="fu">tidyr_new_interface</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  exists <span class="op">=</span>  <span class="fu">tidyr_new_interface1</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  formals <span class="op">=</span> <span class="fu">tidyr_new_interface2</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 5</span></span>
<span><span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc</span></span>
<span><span class="co">#&gt;   &lt;bch:expr&gt; &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;</span></span>
<span><span class="co">#&gt; 1 version     728.9µs  888.4µs     1074.    3.82KB</span></span>
<span><span class="co">#&gt; 2 exists        3.1µs    4.1µs   198150.   17.34MB</span></span>
<span><span class="co">#&gt; 3 formals       1.3µs    1.6µs   438516.        0B</span></span></code></pre></div>
<p>If you do need to use <code><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion()</a></code> inside a performance sensitive function, I recommend caching the result in <code>.onLoad()</code> (which, by convention, lives in <code>zzz.R</code>). There a few ways to do this; but the following block shows one approach that matches the function interface I used above:</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidyr_new_interface</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="cn">FALSE</span></span>
<span><span class="va">.onLoad</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"tidyr"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="st">"0.8.2"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tidyr_new_interface</span> <span class="op">&lt;&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div id="testing-with-multiple-package-versions" class="section level2" number="29.3">
<h2>
<span class="header-section-number">29.3</span> Testing with multiple package versions<a class="anchor" aria-label="anchor" href="#testing-with-multiple-package-versions"><i class="fas fa-link"></i></a>
</h2>
<p>It’s good practice to test both old and new versions of the code, but this is challenging because you can’t both sets of tests in the same R session. The easiest way to make sure that both versions are work and stay working is to use Travis.</p>
<p>Before the dependency is released, you can manually install the development version using <code>remotes::install_github()</code>:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb168-1"><a href="changes-multivers.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span><span class="kw">:</span></span>
<span id="cb168-2"><a href="changes-multivers.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">include</span><span class="kw">:</span></span>
<span id="cb168-3"><a href="changes-multivers.html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">r</span><span class="kw">:</span><span class="at"> release</span></span>
<span id="cb168-4"><a href="changes-multivers.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> tidyr-devel</span></span>
<span id="cb168-5"><a href="changes-multivers.html#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">before_script</span><span class="kw">:</span><span class="at"> Rscript -e "remotes::install_github('tidyverse/tidyr')"</span></span></code></pre></div>
<p>It’s not generally that important to check that your code continues to work with an older version of the package, but if you want to you can use <code>remotes::install_version()</code>:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb169-1"><a href="changes-multivers.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span><span class="kw">:</span></span>
<span id="cb169-2"><a href="changes-multivers.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">include</span><span class="kw">:</span></span>
<span id="cb169-3"><a href="changes-multivers.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">r</span><span class="kw">:</span><span class="at"> release</span></span>
<span id="cb169-4"><a href="changes-multivers.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> tidyr-0.8</span></span>
<span id="cb169-5"><a href="changes-multivers.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">before_script</span><span class="kw">:</span><span class="at"> Rscript -e "remotes::install_version('tidyr', '0.8.3')"</span></span></code></pre></div>
</div>
<div id="using-only-the-new-version" class="section level2" number="29.4">
<h2>
<span class="header-section-number">29.4</span> Using only the new version<a class="anchor" aria-label="anchor" href="#using-only-the-new-version"><i class="fas fa-link"></i></a>
</h2>
<p>At some point in the future, you’ll decide that the old version of the package is no longer widely used and you want to simplify your package by only depending on the new version. There are three steps:</p>
<ul>
<li><p>In the DESCRIPTION, bump the required version of the dependency.</p></li>
<li><p>Search for <code>dependency_has_new_interface()</code>; remove the function defintion
and all uses (retaining the code used with the new version).</p></li>
<li><p>Remove the additional build in <code>.travis.yml</code>.</p></li>
</ul>
</div>
</div>



<div class="chapter-nav">
<div class="prev"><a href="err-constructor.html"><span class="header-section-number">28</span> Error constructors</a></div>
<div class="next"><a href="side-effect-soup.html"><span class="header-section-number">30</span> Side-effect soup</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#changes-multivers"><span class="header-section-number">29</span> Work with multiple dependency versions</a></li>
<li><a class="nav-link" href="#whats-the-pattern-11"><span class="header-section-number">29.1</span> What’s the pattern?</a></li>
<li>
<a class="nav-link" href="#writing-code"><span class="header-section-number">29.2</span> Writing code</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#case-study-tidyr"><span class="header-section-number">29.2.1</span> Case study: tidyr</a></li></ul>
</li>
<li><a class="nav-link" href="#testing-with-multiple-package-versions"><span class="header-section-number">29.3</span> Testing with multiple package versions</a></li>
<li><a class="nav-link" href="#using-only-the-new-version"><span class="header-section-number">29.4</span> Using only the new version</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="http://github.com/tidyverse/design/blob/main/changes-multivers.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="http://github.com/tidyverse/design/edit/main/changes-multivers.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>
</div>
  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Tidyverse design guide</strong>" was written by Tidyverse team. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
