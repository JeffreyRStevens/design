<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>18 Data, dots, details | Tidyverse design guide</title>
<meta name="author" content="Tidyverse team">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="18 Data, dots, details | Tidyverse design guide">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="18 Data, dots, details | Tidyverse design guide">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-115082821-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="18.1 What’s the pattern? When you use ... in a function, where should you put it? It’s obvious that the data arguments must come first. But which should come next, the dots or the details? This...">
<meta property="og:description" content="18.1 What’s the pattern? When you use ... in a function, where should you put it? It’s obvious that the data arguments must come first. But which should come next, the dots or the details? This...">
<meta name="twitter:description" content="18.1 What’s the pattern? When you use ... in a function, where should you put it? It’s obvious that the data arguments must come first. But which should come next, the dots or the details? This...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Tidyverse design guide</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="structure.html"><span class="header-section-number">1</span> Structure</a></li>
<li><a class="" href="unifying-principles.html"><span class="header-section-number">2</span> Unifying principles</a></li>
<li class="book-part">Implementation</li>
<li><a class="" href="names-attribute.html"><span class="header-section-number">3</span> Names attribute</a></li>
<li><a class="" href="call-data-details.html"><span class="header-section-number">4</span> Name details arguments</a></li>
<li><a class="" href="function-names.html"><span class="header-section-number">5</span> Function names</a></li>
<li class="book-part">Interface: inputs</li>
<li><a class="" href="args-hidden.html"><span class="header-section-number">6</span> Avoid hidden arguments</a></li>
<li><a class="" href="args-data-details.html"><span class="header-section-number">7</span> Data, descriptors, details</a></li>
<li><a class="" href="args-independence.html"><span class="header-section-number">8</span> Avoid dependencies between arguments</a></li>
<li><a class="" href="case-study-setnames.html"><span class="header-section-number">9</span> Case study: setNames()</a></li>
<li class="book-part">Interface: default values</li>
<li><a class="" href="def-required.html"><span class="header-section-number">10</span> Required args shouldn’t have defaults</a></li>
<li><a class="" href="cs-rep.html"><span class="header-section-number">11</span> Case study: rep()</a></li>
<li><a class="" href="def-enum.html"><span class="header-section-number">12</span> Enumerate possible options</a></li>
<li><a class="" href="def-magical.html"><span class="header-section-number">13</span> Avoid magical defaults</a></li>
<li><a class="" href="def-short.html"><span class="header-section-number">14</span> Keep defaults short and sweet</a></li>
<li><a class="" href="def-inform.html"><span class="header-section-number">15</span> Explain important defaults</a></li>
<li><a class="" href="def-user.html"><span class="header-section-number">16</span> User settable defaults</a></li>
<li><a class="" href="cs-rgb.html"><span class="header-section-number">17</span> Case study: rgb()</a></li>
<li class="book-part">Interface: ...</li>
<li><a class="active" href="dots-position.html"><span class="header-section-number">18</span> Data, dots, details</a></li>
<li><a class="" href="dots-data.html"><span class="header-section-number">19</span> Making data with …</a></li>
<li><a class="" href="dots-prefix.html"><span class="header-section-number">20</span> Dot prefix</a></li>
<li><a class="" href="dots-inspect.html"><span class="header-section-number">21</span> Inspect the dots</a></li>
<li><a class="" href="cs-mapply-pmap.html"><span class="header-section-number">22</span> Case study: mapply() vs pmap()</a></li>
<li class="book-part">Interface: outputs</li>
<li><a class="" href="out-multi.html"><span class="header-section-number">23</span> Returning multiple values</a></li>
<li><a class="" href="out-type-stability.html"><span class="header-section-number">24</span> Type-stability</a></li>
<li><a class="" href="out-vectorisation.html"><span class="header-section-number">25</span> Vectorisation</a></li>
<li><a class="" href="out-invisible.html"><span class="header-section-number">26</span> Side-effect functions should return invisibly</a></li>
<li class="book-part">Interface: errors</li>
<li><a class="" href="err-call.html"><span class="header-section-number">27</span> Error call</a></li>
<li><a class="" href="err-constructor.html"><span class="header-section-number">28</span> Error constructors</a></li>
<li class="book-part">Interface: changes</li>
<li><a class="" href="changes-multivers.html"><span class="header-section-number">29</span> Work with multiple dependency versions</a></li>
<li class="book-part">Interface: side effects</li>
<li><a class="" href="side-effect-soup.html"><span class="header-section-number">30</span> Side-effect soup</a></li>
<li><a class="" href="spooky-action.html"><span class="header-section-number">31</span> Spooky action</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="glossary.html"><span class="header-section-number">A</span> Glossary</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="http://github.com/tidyverse/design">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="dots-position" class="section level1" number="18">
<h1>
<span class="header-section-number">18</span> Data, dots, details<a class="anchor" aria-label="anchor" href="#dots-position"><i class="fas fa-link"></i></a>
</h1>
<!-- Rename to details in dots? dots-details -->
<div id="whats-the-pattern-6" class="section level2" number="18.1">
<h2>
<span class="header-section-number">18.1</span> What’s the pattern?<a class="anchor" aria-label="anchor" href="#whats-the-pattern-6"><i class="fas fa-link"></i></a>
</h2>
<p>When you use <code>...</code> in a function, where should you put it? It’s obvious that the data arguments must come first. But which should come next, the dots or the details? This pattern tells you to place <code>...</code> between the data arguments (the required arguments that supply the key “data” to the function) and the details arguments (optional additional arguments that control the finer details of the function).</p>
</div>
<div id="what-are-some-examples-9" class="section level2" number="18.2">
<h2>
<span class="header-section-number">18.2</span> What are some examples?<a class="anchor" aria-label="anchor" href="#what-are-some-examples-9"><i class="fas fa-link"></i></a>
</h2>
<p>Many functions in base R take data, then details, then dots:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">unique</span><span class="op">)</span></span>
<span><span class="co">#&gt; function (x, incomparables = FALSE, ...) </span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">median</span><span class="op">)</span></span>
<span><span class="co">#&gt; function (x, na.rm = FALSE, ...) </span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>This doesn’t cause many problems because most people will fully spell out the names of details arguments. However, there are other summary functions that take the data <em>via dots</em>, then details.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/prod.html">prod</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 60</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">sum</span><span class="op">)</span></span>
<span><span class="co">#&gt; function (..., na.rm = FALSE) </span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">prod</span><span class="op">)</span></span>
<span><span class="co">#&gt; function (..., na.rm = FALSE) </span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>This allows these functions to take any number of input vectors, but these two different interfaces make it very easy for users to construct calls that are technically valid, but that don’t return the desired result.</p>
<p>If you’re expecting <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> to work like <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>, you might call it the same way:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
<p>This silently returns an incorrect result because <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> has arguments <code>x</code>, <code>na.rm</code>, and <code>...</code>. The user must remember that <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> – and <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> too! – require data that is packed into a single vector.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5</span></span></code></pre></div>
</div>
<div id="what-is-it-important" class="section level2" number="18.3">
<h2>
<span class="header-section-number">18.3</span> What is it important?<a class="anchor" aria-label="anchor" href="#what-is-it-important"><i class="fas fa-link"></i></a>
</h2>
<p>There are three primary advantages:</p>
<ul>
<li><p>It forces the user of your function to fully name the detail arguments,
because arguments that come after <code>...</code> are never matched by position
or partially by name. Using full names for details arguments is good practice,
because it makes code easier to read.</p></li>
<li><p>You can easily add new detail arguments without changing the meaning of
existing function calls. This makes it easy to extend your function with
new capabilities, because you don’t need to worry about changing existing
code.</p></li>
<li><p>When coupled with “inspect the dots” (Chapter <a href="dots-inspect.html#dots-inspect">21</a>),
or “dot prefix” (Chapter <a href="dots-prefix.html#dots-prefix">20</a>) it minimises the chances that
misspelled arguments names will silently go astray.</p></li>
</ul>
<p>The payoff of this pattern is not huge: it protects against a fairly unusual failure mode. However, the failure mode is silent (so easy to miss), and the pattern is very easy to apply, so I think the payoff is still worth it.</p>
</div>
<div id="how-do-i-do-it" class="section level2" number="18.4">
<h2>
<span class="header-section-number">18.4</span> How do I do it?<a class="anchor" aria-label="anchor" href="#how-do-i-do-it"><i class="fas fa-link"></i></a>
</h2>
<p>Following this pattern is simple: just identity which arguments are data, and which arguments are details and then put the … in between.</p>
</div>
<div id="how-do-i-remediate-it" class="section level2" number="18.5">
<h2>
<span class="header-section-number">18.5</span> How do I remediate it?<a class="anchor" aria-label="anchor" href="#how-do-i-remediate-it"><i class="fas fa-link"></i></a>
</h2>
<p>If you’ve already published a function where you’ve put <code>...</code> in the wrong place, it’s easy to fix. You’ll need to use function from the ellipsis package to check that <code>...</code> is as expected (e.g. from Chapters <a href="dots-inspect.html#dots-inspect">21</a> or <a href="dots-data.html#dots-data">19</a>). Since using the full names for details arguments is good practice, making this change will typically affect little existing code, but it is an interface change so should be advertised prominently.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old_interface</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">data1</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">data2</span> <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">new_interace</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">data1</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">data2</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ellipsis</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/check_dots_used.html">check_dots_used</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We can use this approach to make a safer version of <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code>:</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">safe_median</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, <span class="va">na.rm</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ellipsis</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/check_dots_used.html">check_dots_used</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">safe_median</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `safe_median()`:</span></span>
<span><span class="co">#&gt; ! Arguments in `...` must be used.</span></span>
<span><span class="co">#&gt; ✖ Problematic arguments:</span></span>
<span><span class="co">#&gt; • ..1 = 3</span></span>
<span><span class="co">#&gt; • ..2 = 10</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cs-rgb.html"><span class="header-section-number">17</span> Case study: rgb()</a></div>
<div class="next"><a href="dots-data.html"><span class="header-section-number">19</span> Making data with …</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#dots-position"><span class="header-section-number">18</span> Data, dots, details</a></li>
<li><a class="nav-link" href="#whats-the-pattern-6"><span class="header-section-number">18.1</span> What’s the pattern?</a></li>
<li><a class="nav-link" href="#what-are-some-examples-9"><span class="header-section-number">18.2</span> What are some examples?</a></li>
<li><a class="nav-link" href="#what-is-it-important"><span class="header-section-number">18.3</span> What is it important?</a></li>
<li><a class="nav-link" href="#how-do-i-do-it"><span class="header-section-number">18.4</span> How do I do it?</a></li>
<li><a class="nav-link" href="#how-do-i-remediate-it"><span class="header-section-number">18.5</span> How do I remediate it?</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="http://github.com/tidyverse/design/blob/main/dots-position.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="http://github.com/tidyverse/design/edit/main/dots-position.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Tidyverse design guide</strong>" was written by Tidyverse team. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
