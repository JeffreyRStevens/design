<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Data, descriptors, details | Tidyverse design guide</title>
<meta name="author" content="Tidyverse team">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="7 Data, descriptors, details | Tidyverse design guide">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Data, descriptors, details | Tidyverse design guide">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-115082821-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="7.1 What’s the pattern? Function arguments should always come in the same order: data, then descriptors, then details. Data arguments provide the core data. They are required, and are usually...">
<meta property="og:description" content="7.1 What’s the pattern? Function arguments should always come in the same order: data, then descriptors, then details. Data arguments provide the core data. They are required, and are usually...">
<meta name="twitter:description" content="7.1 What’s the pattern? Function arguments should always come in the same order: data, then descriptors, then details. Data arguments provide the core data. They are required, and are usually...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Tidyverse design guide</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="structure.html"><span class="header-section-number">1</span> Structure</a></li>
<li><a class="" href="unifying-principles.html"><span class="header-section-number">2</span> Unifying principles</a></li>
<li class="book-part">Implementation</li>
<li><a class="" href="names-attribute.html"><span class="header-section-number">3</span> Names attribute</a></li>
<li><a class="" href="call-data-details.html"><span class="header-section-number">4</span> Name details arguments</a></li>
<li><a class="" href="function-names.html"><span class="header-section-number">5</span> Function names</a></li>
<li class="book-part">Interface: inputs</li>
<li><a class="" href="args-hidden.html"><span class="header-section-number">6</span> Avoid hidden arguments</a></li>
<li><a class="active" href="args-data-details.html"><span class="header-section-number">7</span> Data, descriptors, details</a></li>
<li><a class="" href="args-independence.html"><span class="header-section-number">8</span> Avoid dependencies between arguments</a></li>
<li><a class="" href="case-study-setnames.html"><span class="header-section-number">9</span> Case study: setNames()</a></li>
<li class="book-part">Interface: default values</li>
<li><a class="" href="def-required.html"><span class="header-section-number">10</span> Required args shouldn’t have defaults</a></li>
<li><a class="" href="cs-rep.html"><span class="header-section-number">11</span> Case study: rep()</a></li>
<li><a class="" href="def-enum.html"><span class="header-section-number">12</span> Enumerate possible options</a></li>
<li><a class="" href="def-magical.html"><span class="header-section-number">13</span> Avoid magical defaults</a></li>
<li><a class="" href="def-short.html"><span class="header-section-number">14</span> Keep defaults short and sweet</a></li>
<li><a class="" href="def-inform.html"><span class="header-section-number">15</span> Explain important defaults</a></li>
<li><a class="" href="def-user.html"><span class="header-section-number">16</span> User settable defaults</a></li>
<li><a class="" href="cs-rgb.html"><span class="header-section-number">17</span> Case study: rgb()</a></li>
<li class="book-part">Interface: ...</li>
<li><a class="" href="dots-position.html"><span class="header-section-number">18</span> Data, dots, details</a></li>
<li><a class="" href="dots-data.html"><span class="header-section-number">19</span> Making data with …</a></li>
<li><a class="" href="dots-prefix.html"><span class="header-section-number">20</span> Dot prefix</a></li>
<li><a class="" href="dots-inspect.html"><span class="header-section-number">21</span> Inspect the dots</a></li>
<li><a class="" href="cs-mapply-pmap.html"><span class="header-section-number">22</span> Case study: mapply() vs pmap()</a></li>
<li class="book-part">Interface: outputs</li>
<li><a class="" href="out-multi.html"><span class="header-section-number">23</span> Returning multiple values</a></li>
<li><a class="" href="out-type-stability.html"><span class="header-section-number">24</span> Type-stability</a></li>
<li><a class="" href="out-vectorisation.html"><span class="header-section-number">25</span> Vectorisation</a></li>
<li><a class="" href="out-invisible.html"><span class="header-section-number">26</span> Side-effect functions should return invisibly</a></li>
<li class="book-part">Interface: errors</li>
<li><a class="" href="err-call.html"><span class="header-section-number">27</span> Error call</a></li>
<li><a class="" href="err-constructor.html"><span class="header-section-number">28</span> Error constructors</a></li>
<li class="book-part">Interface: changes</li>
<li><a class="" href="changes-multivers.html"><span class="header-section-number">29</span> Work with multiple dependency versions</a></li>
<li class="book-part">Interface: side effects</li>
<li><a class="" href="side-effect-soup.html"><span class="header-section-number">30</span> Side-effect soup</a></li>
<li><a class="" href="spooky-action.html"><span class="header-section-number">31</span> Spooky action</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="glossary.html"><span class="header-section-number">A</span> Glossary</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="http://github.com/tidyverse/design">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="args-data-details" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Data, descriptors, details<a class="anchor" aria-label="anchor" href="#args-data-details"><i class="fas fa-link"></i></a>
</h1>
<div id="whats-the-pattern-1" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> What’s the pattern?<a class="anchor" aria-label="anchor" href="#whats-the-pattern-1"><i class="fas fa-link"></i></a>
</h2>
<p>Function arguments should always come in the same order: data, then descriptors, then details.</p>
<ul>
<li><p><strong>Data</strong> arguments provide the core data. They are required, and are usually
vectors and often determine the type and size of the output. Data arguments
are often called <code>data</code>, <code>x</code>, or <code>y</code>.</p></li>
<li><p><strong>Descriptor</strong> arguments describe essential details of the operation, and
are usually required.</p></li>
<li><p><strong>Details</strong> arguments control the details of the function. These arguments
are optional (because they have default values), and are typically scalars
(e.g. <code>na.rm = TRUE</code>, <code>n = 10</code>, <code>prop = 0.1</code>).</p></li>
</ul>
<p>A standard argument order makes it easier to understand a function at a glance, and this order implies that required arguments always come before optional arguments.</p>
<p>Related patterns:</p>
<ul>
<li><p><code>...</code> can play the role of the data argument (i.e. when there are an
arbitrary number of inputs), as in <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code>. This pattern is best using
sparingly, and is described in more detail in Chapter <a href="dots-data.html#dots-data">19</a>.</p></li>
<li><p><code>...</code> can also be used to capture details arguments and pass them on to
other functions. See Chapters <a href="dots-position.html#dots-position">18</a> and <a href="dots-inspect.html#dots-inspect">21</a>
to how to use <code>...</code> as safely as possible in this situation.</p></li>
<li><p>If the descriptor has a default value, I think you should inform the user
about it, as in Chapter <a href="def-inform.html#def-inform">15</a>.</p></li>
</ul>
</div>
<div id="what-are-some-examples-1" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> What are some examples?<a class="anchor" aria-label="anchor" href="#what-are-some-examples-1"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p><code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> has one data argument (<code>x</code>) and two details (<code>trim</code> and <code>na.rm</code>).</p></li>
<li><p>The mathematical (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, …) and comparison (<code>&lt;</code>, <code>&gt;</code>, <code>==</code>,
…) operators have two data arguments.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> has three data arguments (<code>test</code>, <code>yes</code>, <code>no</code>).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/merge.html">merge()</a></code> has two data arguments (<code>x</code>, <code>y</code>), one descriptor (<code>by</code>),
and a number of details (<code>all</code>, <code>no.dups</code>, <code>sort</code>, …).</p></li>
<li>
<p><code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> has no data arguments and three descriptors (<code>n</code>, <code>mean</code>, <code>sd</code>).
<code>mean</code> and <code>sd</code> default to 0 and 1 respectively, which makes them feel
more like details. I’d argue that they shouldn’t have defaults to make it
more clear that they’re descriptors. This would have the side-effect of
making <code>rnrorm()</code> more consistent with the other RNGs.</p>
<p>In <code>rt(n, df, ncp)</code>, however, I think <code>ncp</code> should default to <code>0</code> to make
it clear that the non-centrality parameter is detail of the t-distribution,
not a core part.</p>
</li>
<li><p><code><a href="https://rdrr.io/r/base/grep.html">grepl()</a></code> has one data argument (<code>x</code>), one descriptor (<code>pattern</code>), and a
number of details (<code>fixed</code>, <code>perl</code>, <code>ignore.case</code>, …).</p></li>
<li><p><code><a href="https://stringr.tidyverse.org/reference/str_detect.html">stringr::str_detect()</a></code> has one data argument (<code>string</code>), one descriptor
(<code>pattern</code>), and one detail argument (<code>negate</code>).</p></li>
<li>
<p><code><a href="https://stringr.tidyverse.org/reference/str_sub.html">stringr::str_sub()</a></code> has three data arguments (<code>string</code>, <code>start</code>, and
<code>end</code>). You might wonder what makes <code>start</code> and <code>end</code> data arguments, and
I admit it took me a while to figure this out too, but I think the
crucial factor is that you can give a single <code>string</code> and multiple
<code>start</code>/<code>end</code> positions:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span><span class="op">(</span><span class="st">"Hello"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Hello" "ello"  "llo"   "lo"    "o"</span></span></code></pre></div>
<p>If I was to write <code><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub()</a></code> today, I’d call the first argument <code>x</code>, and
I wouldn’t give <code>start</code> and <code>end</code> default values.</p>
</li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot2::ggplot()</a></code> has one data argument (<code>data</code>) and one descriptor
(<code>mapping</code>).</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> has one data argument (<code>data</code>), one descriptor (<code>formula</code>), and
many details (<code>weights</code>, <code>na.action</code>, <code>method</code>, …). Unfortunately
<code>formula</code> comes before <code>data</code>. This is a historical accident, because
putting all model variables into a data frame is a relatively recent
innovation in the long life cycle of <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p></li>
<li><p><code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map()</a></code> has one data argument (<code>.x</code>) and one descriptor (<code>.f</code>).
<code><a href="https://purrr.tidyverse.org/reference/map2.html">purrr::map2()</a></code> has two data arguments (<code>.x</code>, <code>.y</code>) and one descrptor
(<code>.f</code>).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/mapply.html">mapply()</a></code> has any number of data arguments (…), one descriptor (<code>FUN</code>),
and a number of details (<code>SIMPLIFY</code>, <code>USE.NAMES</code>, …). The descriptor
comes before the data arguments.</p></li>
<li>
<p>At first glance it looks like the ggplot2 layer functions, like
<code>geom_point()</code>, don’t obey this principle because the first argument is
<code>mapping</code> (a descriptor) and the second is <code>data</code> (presumably a data
argument). However, this is because ggplot2 doesn’t use the pipe. If it
did (like <a href="https://github.com/hadley/ggplot1">ggplot1</a>), the first
argument would be the plot to modify, which is the data object in this case,
because the output is also a plot. Here <code>data</code> acts a descriptor, because
it modifies the behaviour of the layer.</p>
<p>The argument order differs between the layers and <code>ggplot()</code>, because you
more commonly specify the data for the plot, and the aesthetic mappings
for the layers. This is a little confusing, but I think time has shown it
to be a reasonable design decision.</p>
</li>
</ul>
</div>
<div id="why-is-it-important-1" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Why is it important?<a class="anchor" aria-label="anchor" href="#why-is-it-important-1"><i class="fas fa-link"></i></a>
</h2>
<p>This convention makes it easy to understand the structure of a function at a glance: the most important arguments are always on the left hand side, and it’s obvious what arguments most affect the shape of the output. Strongly connecting the shape of the first argument to the shape of output is what makes dplyr (data frames), stringr (character vectors), and the map family (vectors) easier to learn. These families of functions represent transformations that preserve the shape while modifying the value. When combined with the pipe, this leads to code that focusses on the transformations, not the objects being transformed.</p>
<p>These argument types as also affect how you <em>call</em> a function. As discussed in Chapter <a href="call-data-details.html#call-data-details">4</a>, you should never name data arguments, and always name details arguments. This convention balances concision with readability.</p>
</div>
<div id="how-do-i-avoid-the-problem" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> How do I avoid the problem?<a class="anchor" aria-label="anchor" href="#how-do-i-avoid-the-problem"><i class="fas fa-link"></i></a>
</h2>
<p>To avoid the problem, you have to carefully analyse the arguments to ensure that you correctly categorise each argument. It’s generally easy to tell the difference between a data argument and a details argument, particularly because data arguments are required and details arguments are optional. But it can be harder to distinguish between data and descriptor, or descriptor and details. This is partly because my categorisation is false trichotomy: there’s really more of a continuous gradient from absolutely required to totally optional than discrete steps. Nevertheless, I think these three categories are useful, and even if you don’t get it absolutely right every time, this framework will help you do better on average.</p>
<p>There are a couple of heuristics that you can also check for:</p>
<ul>
<li><p>Are the arguments generally ordered from most important to least important?
If an important argument comes before an unimportant argument, you may have
assigned an argument to the wrong category. (Note that this ordering isn’t
strict: sometimes it’s more important to organise related arguments together
than to precisely order by importance.)</p></li>
<li><p>Do any arguments with defaults come before any arguments without defaults?
This may be a sign that the argument order is wrong, or that you’ve
assigned a default value to an required argument (See Chapter
@ref(#def-required) for more details.)</p></li>
</ul>
</div>
<div id="how-do-i-remediate-past-mistakes" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> How do I remediate past mistakes?<a class="anchor" aria-label="anchor" href="#how-do-i-remediate-past-mistakes"><i class="fas fa-link"></i></a>
</h2>
<p>Generally, it is not possible to fix an exported function preserving both old behaviour and new behaviour. Typically, you will need to perform major surgery on the function arguments, and it will convey different conventions about which arguments should be named. This implies that you should deprecate the entire existing function and replace it with a new alternative. Because this is invasive to the user, it’s best to do sparingly: if the mistake is minor, you’re better off waiting until you’ve collected other problems before fixing it.</p>
<p>Take <code><a href="https://tidyr.tidyverse.org/reference/gather.html">tidyr::gather()</a></code>, for example. It has a number of problems with its design that made them hard to use. Relevant to this chapter, is that the argument order is wrong.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="args-hidden.html"><span class="header-section-number">6</span> Avoid hidden arguments</a></div>
<div class="next"><a href="args-independence.html"><span class="header-section-number">8</span> Avoid dependencies between arguments</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#args-data-details"><span class="header-section-number">7</span> Data, descriptors, details</a></li>
<li><a class="nav-link" href="#whats-the-pattern-1"><span class="header-section-number">7.1</span> What’s the pattern?</a></li>
<li><a class="nav-link" href="#what-are-some-examples-1"><span class="header-section-number">7.2</span> What are some examples?</a></li>
<li><a class="nav-link" href="#why-is-it-important-1"><span class="header-section-number">7.3</span> Why is it important?</a></li>
<li><a class="nav-link" href="#how-do-i-avoid-the-problem"><span class="header-section-number">7.4</span> How do I avoid the problem?</a></li>
<li><a class="nav-link" href="#how-do-i-remediate-past-mistakes"><span class="header-section-number">7.5</span> How do I remediate past mistakes?</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="http://github.com/tidyverse/design/blob/main/args-data-details.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="http://github.com/tidyverse/design/edit/main/args-data-details.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Tidyverse design guide</strong>" was written by Tidyverse team. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
