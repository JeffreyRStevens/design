<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>19 Making data with … | Tidyverse design guide</title>
<meta name="author" content="Tidyverse team">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="19 Making data with … | Tidyverse design guide">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="19 Making data with … | Tidyverse design guide">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-115082821-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="19.1 What’s the problem? A number of functions take ... to save the user from having to create a vector themselves:  19.2 What are some examples? sum(c(1, 1, 1)) #&gt; [1] 3 # can be shortened to:...">
<meta property="og:description" content="19.1 What’s the problem? A number of functions take ... to save the user from having to create a vector themselves:  19.2 What are some examples? sum(c(1, 1, 1)) #&gt; [1] 3 # can be shortened to:...">
<meta name="twitter:description" content="19.1 What’s the problem? A number of functions take ... to save the user from having to create a vector themselves:  19.2 What are some examples? sum(c(1, 1, 1)) #&gt; [1] 3 # can be shortened to:...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Tidyverse design guide</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="structure.html"><span class="header-section-number">1</span> Structure</a></li>
<li><a class="" href="unifying-principles.html"><span class="header-section-number">2</span> Unifying principles</a></li>
<li class="book-part">Implementation</li>
<li><a class="" href="names-attribute.html"><span class="header-section-number">3</span> Names attribute</a></li>
<li><a class="" href="call-data-details.html"><span class="header-section-number">4</span> Name details arguments</a></li>
<li><a class="" href="function-names.html"><span class="header-section-number">5</span> Function names</a></li>
<li class="book-part">Interface: inputs</li>
<li><a class="" href="args-hidden.html"><span class="header-section-number">6</span> Avoid hidden arguments</a></li>
<li><a class="" href="args-data-details.html"><span class="header-section-number">7</span> Data, descriptors, details</a></li>
<li><a class="" href="args-independence.html"><span class="header-section-number">8</span> Avoid dependencies between arguments</a></li>
<li><a class="" href="case-study-setnames.html"><span class="header-section-number">9</span> Case study: setNames()</a></li>
<li class="book-part">Interface: default values</li>
<li><a class="" href="def-required.html"><span class="header-section-number">10</span> Required args shouldn’t have defaults</a></li>
<li><a class="" href="cs-rep.html"><span class="header-section-number">11</span> Case study: rep()</a></li>
<li><a class="" href="def-enum.html"><span class="header-section-number">12</span> Enumerate possible options</a></li>
<li><a class="" href="def-magical.html"><span class="header-section-number">13</span> Avoid magical defaults</a></li>
<li><a class="" href="def-short.html"><span class="header-section-number">14</span> Keep defaults short and sweet</a></li>
<li><a class="" href="def-inform.html"><span class="header-section-number">15</span> Explain important defaults</a></li>
<li><a class="" href="def-user.html"><span class="header-section-number">16</span> User settable defaults</a></li>
<li><a class="" href="cs-rgb.html"><span class="header-section-number">17</span> Case study: rgb()</a></li>
<li class="book-part">Interface: ...</li>
<li><a class="" href="dots-position.html"><span class="header-section-number">18</span> Data, dots, details</a></li>
<li><a class="active" href="dots-data.html"><span class="header-section-number">19</span> Making data with …</a></li>
<li><a class="" href="dots-prefix.html"><span class="header-section-number">20</span> Dot prefix</a></li>
<li><a class="" href="dots-inspect.html"><span class="header-section-number">21</span> Inspect the dots</a></li>
<li><a class="" href="cs-mapply-pmap.html"><span class="header-section-number">22</span> Case study: mapply() vs pmap()</a></li>
<li class="book-part">Interface: outputs</li>
<li><a class="" href="out-multi.html"><span class="header-section-number">23</span> Returning multiple values</a></li>
<li><a class="" href="out-type-stability.html"><span class="header-section-number">24</span> Type-stability</a></li>
<li><a class="" href="out-vectorisation.html"><span class="header-section-number">25</span> Vectorisation</a></li>
<li><a class="" href="out-invisible.html"><span class="header-section-number">26</span> Side-effect functions should return invisibly</a></li>
<li class="book-part">Interface: errors</li>
<li><a class="" href="err-call.html"><span class="header-section-number">27</span> Error call</a></li>
<li><a class="" href="err-constructor.html"><span class="header-section-number">28</span> Error constructors</a></li>
<li class="book-part">Interface: changes</li>
<li><a class="" href="changes-multivers.html"><span class="header-section-number">29</span> Work with multiple dependency versions</a></li>
<li class="book-part">Interface: side effects</li>
<li><a class="" href="side-effect-soup.html"><span class="header-section-number">30</span> Side-effect soup</a></li>
<li><a class="" href="spooky-action.html"><span class="header-section-number">31</span> Spooky action</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="glossary.html"><span class="header-section-number">A</span> Glossary</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="http://github.com/tidyverse/design">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="dots-data" class="section level1" number="19">
<h1>
<span class="header-section-number">19</span> Making data with …<a class="anchor" aria-label="anchor" href="#dots-data"><i class="fas fa-link"></i></a>
</h1>
<div id="whats-the-problem-4" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> What’s the problem?<a class="anchor" aria-label="anchor" href="#whats-the-problem-4"><i class="fas fa-link"></i></a>
</h2>
<p>A number of functions take <code>...</code> to save the user from having to create a vector themselves:</p>
</div>
<div id="what-are-some-examples-10" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> What are some examples?<a class="anchor" aria-label="anchor" href="#what-are-some-examples-10"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co"># can be shortened to:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">f</span></span>
<span><span class="co">#&gt; [1] a b c d</span></span>
<span><span class="co">#&gt; Levels: b c d a</span></span>
<span><span class="fu">fct_relevel</span><span class="op">(</span><span class="va">f</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] a b c d</span></span>
<span><span class="co">#&gt; Levels: b a c d</span></span>
<span><span class="co"># can be shortened to:</span></span>
<span><span class="fu">fct_relevel</span><span class="op">(</span><span class="va">f</span>, <span class="st">"b"</span>, <span class="st">"a"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] a b c d</span></span>
<span><span class="co">#&gt; Levels: b a c d</span></span></code></pre></div>
<ul>
<li><code><a href="https://rdrr.io/r/base/mapply.html">mapply()</a></code></li>
</ul>
</div>
<div id="why-is-it-important-6" class="section level2" number="19.3">
<h2>
<span class="header-section-number">19.3</span> Why is it important?<a class="anchor" aria-label="anchor" href="#why-is-it-important-6"><i class="fas fa-link"></i></a>
</h2>
<p>In general, I think it is best to avoid using <code>...</code> for this purpose because it has a relatively small benefit, only reducing typing by three letters <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>, but has a number of costs:</p>
<ul>
<li>
<p>It can give the misleading impression that other functions in the same
family work the same way. For example, if you’re internalised how <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>
works, you might predict that <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> works the same way, but it does
not:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>(See Chapter <a href="dots-position.html#dots-position">18</a> to learn why this doesn’t give an
error message.)</p>
</li>
<li>
<p>It makes it harder to adapt the function for new uses. For example,
<code>fct_relevel()</code> can also be called with a function:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fct_relevel</span><span class="op">(</span><span class="va">f</span>, <span class="va">sort</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] a b c d</span></span>
<span><span class="co">#&gt; Levels: a b c d</span></span></code></pre></div>
<p>If <code>fct_relevel()</code> took its input as a single vector, you could easily
extend it to also work with functions:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fct_relevel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span>, <span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.function.html">is.function</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>However, because <code>fct_relevel()</code> uses dots, the implementation needs to be
more complicated:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fct_relevel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rlang.r-lib.org/reference/dots_n.html">dots_n</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1L</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/is.function.html">is.function</a></span><span class="op">(</span><span class="va">..1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">levels</span> <span class="op">&lt;-</span> <span class="fu">fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</li>
</ul>
</div>
<div id="what-are-the-exceptions-4" class="section level2" number="19.4">
<h2>
<span class="header-section-number">19.4</span> What are the exceptions?<a class="anchor" aria-label="anchor" href="#what-are-the-exceptions-4"><i class="fas fa-link"></i></a>
</h2>
<p>Note that in all the examples above, the <code>...</code> are used to collect a single details argument. It’s ok to use <code>...</code> to collect <em>data</em>, as in <code><a href="https://rdrr.io/r/base/paste.html">paste()</a></code>, <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code>, or <code><a href="https://rdrr.io/r/base/list.html">list()</a></code>.</p>
</div>
<div id="how-can-remediate-it" class="section level2" number="19.5">
<h2>
<span class="header-section-number">19.5</span> How can remediate it?<a class="anchor" aria-label="anchor" href="#how-can-remediate-it"><i class="fas fa-link"></i></a>
</h2>
<p>If you’ve already published a function where you’ve used <code>...</code> for this purpose you can change the interface by adding a new argument in front of <code>...</code>, and then warning if anything ends up in <code>...</code>.</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old_foo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">new_foo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/dots_n.html">dots_n</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="st">"Use of `...` is now deprecated. Please put all arguments in `y`"</span><span class="op">)</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Because this is a interface change, it should be prominently advertised in packages.</p>
</div>
<div id="how-can-i-protect-myself" class="section level2" number="19.6">
<h2>
<span class="header-section-number">19.6</span> How can I protect myself?<a class="anchor" aria-label="anchor" href="#how-can-i-protect-myself"><i class="fas fa-link"></i></a>
</h2>
<p>If you do feel that the tradeoff is worth it (i.e. it’s an extremely frequently used function and the savings over time will be considerable), you need to take some steps to minimise the downsides.</p>
<p>This is easiest if you’re constructing a vector that shouldn’t have names. In this case, you can call <code><a href="https://rlang.r-lib.org/reference/check_dots_unnamed.html">ellipsis::check_dots_unnamed()</a></code> to ensure that no named arguments have been accidentally passed to <code>...</code>. This protects you against the following undesirable behaviour of <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, na.omit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span></span>
<span><span class="va">safe_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">na.rm</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ellipsis</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/check_dots_unnamed.html">check_dots_unnamed</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="va">na.rm</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">safe_sum</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, na.omit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `safe_sum()`:</span></span>
<span><span class="co">#&gt; ! Arguments in `...` must be passed by position, not name.</span></span>
<span><span class="co">#&gt; ✖ Problematic argument:</span></span>
<span><span class="co">#&gt; • na.omit = TRUE</span></span></code></pre></div>
<p>If you want your vector to have names, the problem is harder, and there’s relatively little that you can. You’ll need to ensure that all other arguments get a <code>.</code> prefix (to minimise chances of a mismatch) and then think carefully about how you might detect problems by thinking about the expect type of <code>c(...)</code>. As far as I know, there are no general techniques, and you’ll have to think about the problem on a case-by-case basis.</p>
</div>
<div id="selecting-variables" class="section level2" number="19.7">
<h2>
<span class="header-section-number">19.7</span> Selecting variables<a class="anchor" aria-label="anchor" href="#selecting-variables"><i class="fas fa-link"></i></a>
</h2>
<p>A number of funtions in the tidyverse use <code>...</code> for selecting variables. For example, <code><a href="https://tidyr.tidyverse.org/reference/fill.html">tidyr::fill()</a></code> lets you fill in missing values based on the previous row:</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">year</span>,  <span class="op">~</span><span class="va">month</span>, <span class="op">~</span><span class="va">day</span>,</span>
<span>  <span class="fl">2020</span>,  <span class="fl">1</span>,       <span class="fl">1</span>,</span>
<span>  <span class="cn">NA</span>,    <span class="cn">NA</span>,      <span class="fl">2</span>,</span>
<span>  <span class="cn">NA</span>,    <span class="cn">NA</span>,      <span class="fl">3</span>,</span>
<span>  <span class="cn">NA</span>,    <span class="fl">2</span>,       <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">fill</span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;    year month   day</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  2020     1     1</span></span>
<span><span class="co">#&gt; 2  2020     1     2</span></span>
<span><span class="co">#&gt; 3  2020     1     3</span></span>
<span><span class="co">#&gt; 4  2020     2     1</span></span></code></pre></div>
<p>All functions that work like this include a call to <code><a href="https://tidyselect.r-lib.org/reference/vars_select.html">tidyselect::vars_select()</a></code> that looks something like this:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">find_vars</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/vars_select.html">vars_select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">find_vars</span><span class="op">(</span><span class="va">df</span>, <span class="va">year</span>, <span class="va">month</span><span class="op">)</span></span>
<span><span class="co">#&gt;    year   month </span></span>
<span><span class="co">#&gt;  "year" "month"</span></span></code></pre></div>
<p>I now think that this interface is a mistake because it suffers from the same problem as <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code>: we’re using <code>...</code> to only save a little typing. We can eliminate the use of dots by requiring the user to use <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>. (This change also requires explicit quoting and unquoting of <code>vars</code> since we’re no longer using <code>...</code>.)</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">foo</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">vars</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/vars_select.html">vars_select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/enquo.html">enquo</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">find_vars</span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    year   month </span></span>
<span><span class="co">#&gt;  "year" "month"</span></span></code></pre></div>
<p>In other words, I believe that better interface to <code>fill()</code> would be:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">fill</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Other tidyverse functions like dplyr’s scoped verbs and <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">ggplot2::facet_grid()</a></code> require the user to explicitly quote the input. I now believe that this is also a suboptimal interface because it is more typing (<code><a href="https://rdrr.io/r/stats/cor.html">var()</a></code> is longer than <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>, and you must quote even single variables), and arguments that require their inputs to be explicitly quoted are rare in the tidyverse.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># existing interface</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">:</span><span class="va">vs</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co"># what I would create today</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">:</span><span class="va">vs</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># existing interface</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">drv</span><span class="op">)</span>, cols <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">vs</span>, <span class="va">am</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># what I would create today</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="va">drv</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">vs</span>, <span class="va">am</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>That said, it is unlikely we will ever change functions, because the benefit is smaller (primarily improved consistency) and the costs are high, as it impossible to switch from an evaluated argument to a quoted argument without breaking backward compatibility in some small percentage of cases.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="dots-position.html"><span class="header-section-number">18</span> Data, dots, details</a></div>
<div class="next"><a href="dots-prefix.html"><span class="header-section-number">20</span> Dot prefix</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#dots-data"><span class="header-section-number">19</span> Making data with …</a></li>
<li><a class="nav-link" href="#whats-the-problem-4"><span class="header-section-number">19.1</span> What’s the problem?</a></li>
<li><a class="nav-link" href="#what-are-some-examples-10"><span class="header-section-number">19.2</span> What are some examples?</a></li>
<li><a class="nav-link" href="#why-is-it-important-6"><span class="header-section-number">19.3</span> Why is it important?</a></li>
<li><a class="nav-link" href="#what-are-the-exceptions-4"><span class="header-section-number">19.4</span> What are the exceptions?</a></li>
<li><a class="nav-link" href="#how-can-remediate-it"><span class="header-section-number">19.5</span> How can remediate it?</a></li>
<li><a class="nav-link" href="#how-can-i-protect-myself"><span class="header-section-number">19.6</span> How can I protect myself?</a></li>
<li><a class="nav-link" href="#selecting-variables"><span class="header-section-number">19.7</span> Selecting variables</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="http://github.com/tidyverse/design/blob/main/dots-data.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="http://github.com/tidyverse/design/edit/main/dots-data.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Tidyverse design guide</strong>" was written by Tidyverse team. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
