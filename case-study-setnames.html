<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Case study: setNames() | Tidyverse design guide</title>
  <meta name="description" content="9 Case study: setNames() | Tidyverse design guide" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Case study: setNames() | Tidyverse design guide" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="tidyverse/design" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Case study: setNames() | Tidyverse design guide" />
  
  
  

<meta name="author" content="Tidyverse team" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="args-independence.html"/>
<link rel="next" href="def-required.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">tidyverse design principles</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>1</b> Structure</a>
<ul>
<li class="chapter" data-level="1.1" data-path="structure.html"><a href="structure.html#implementation"><i class="fa fa-check"></i><b>1.1</b> Implementation</a></li>
<li class="chapter" data-level="1.2" data-path="structure.html"><a href="structure.html#interface"><i class="fa fa-check"></i><b>1.2</b> Interface</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="structure.html"><a href="structure.html#inputs"><i class="fa fa-check"></i><b>1.2.1</b> Inputs</a></li>
<li class="chapter" data-level="1.2.2" data-path="structure.html"><a href="structure.html#output"><i class="fa fa-check"></i><b>1.2.2</b> Output</a></li>
<li class="chapter" data-level="1.2.3" data-path="structure.html"><a href="structure.html#errors"><i class="fa fa-check"></i><b>1.2.3</b> Errors</a></li>
<li class="chapter" data-level="1.2.4" data-path="structure.html"><a href="structure.html#side-effects"><i class="fa fa-check"></i><b>1.2.4</b> Side-effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="unifying-principles.html"><a href="unifying-principles.html"><i class="fa fa-check"></i><b>2</b> Unifying principles</a>
<ul>
<li class="chapter" data-level="" data-path="unifying-principles.html"><a href="unifying-principles.html#related-work"><i class="fa fa-check"></i>Related work</a></li>
<li class="chapter" data-level="2.1" data-path="unifying-principles.html"><a href="unifying-principles.html#human-centered"><i class="fa fa-check"></i><b>2.1</b> Human centered</a></li>
<li class="chapter" data-level="2.2" data-path="unifying-principles.html"><a href="unifying-principles.html#consistent"><i class="fa fa-check"></i><b>2.2</b> Consistent</a></li>
<li class="chapter" data-level="2.3" data-path="unifying-principles.html"><a href="unifying-principles.html#composable"><i class="fa fa-check"></i><b>2.3</b> Composable</a></li>
<li class="chapter" data-level="2.4" data-path="unifying-principles.html"><a href="unifying-principles.html#inclusive"><i class="fa fa-check"></i><b>2.4</b> Inclusive</a></li>
</ul></li>
<li class="part"><span><b>I Implementation</b></span></li>
<li class="chapter" data-level="3" data-path="names-attribute.html"><a href="names-attribute.html"><i class="fa fa-check"></i><b>3</b> Names attribute</a>
<ul>
<li class="chapter" data-level="3.1" data-path="names-attribute.html"><a href="names-attribute.html#coverage-in-tidyverse-style-guide"><i class="fa fa-check"></i><b>3.1</b> Coverage in tidyverse style guide</a></li>
<li class="chapter" data-level="3.2" data-path="names-attribute.html"><a href="names-attribute.html#the-names-attribute-of-an-object"><i class="fa fa-check"></i><b>3.2</b> The <code>names</code> attribute of an object</a></li>
<li class="chapter" data-level="3.3" data-path="names-attribute.html"><a href="names-attribute.html#minimal-unique-universal"><i class="fa fa-check"></i><b>3.3</b> Minimal, unique, universal</a></li>
<li class="chapter" data-level="3.4" data-path="names-attribute.html"><a href="names-attribute.html#minimal-names"><i class="fa fa-check"></i><b>3.4</b> Minimal names</a></li>
<li class="chapter" data-level="3.5" data-path="names-attribute.html"><a href="names-attribute.html#unique-names"><i class="fa fa-check"></i><b>3.5</b> Unique names</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="names-attribute.html"><a href="names-attribute.html#making-names-unique"><i class="fa fa-check"></i><b>3.5.1</b> Making names unique</a></li>
<li class="chapter" data-level="3.5.2" data-path="names-attribute.html"><a href="names-attribute.html#roundtrips"><i class="fa fa-check"></i><b>3.5.2</b> Roundtrips</a></li>
<li class="chapter" data-level="3.5.3" data-path="names-attribute.html"><a href="names-attribute.html#when-is-minimal-better-than-unique"><i class="fa fa-check"></i><b>3.5.3</b> When is minimal better than unique?</a></li>
<li class="chapter" data-level="3.5.4" data-path="names-attribute.html"><a href="names-attribute.html#ugly-with-a-purpose"><i class="fa fa-check"></i><b>3.5.4</b> Ugly, with a purpose</a></li>
<li class="chapter" data-level="3.5.5" data-path="names-attribute.html"><a href="names-attribute.html#why-so-many-dots"><i class="fa fa-check"></i><b>3.5.5</b> Why so many dots?</a></li>
<li class="chapter" data-level="3.5.6" data-path="names-attribute.html"><a href="names-attribute.html#why-dots-in-the-first-place"><i class="fa fa-check"></i><b>3.5.6</b> Why dot(s) in the first place?</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="names-attribute.html"><a href="names-attribute.html#universal-names"><i class="fa fa-check"></i><b>3.6</b> Universal names</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="names-attribute.html"><a href="names-attribute.html#syntactic-names"><i class="fa fa-check"></i><b>3.6.1</b> Syntactic names</a></li>
<li class="chapter" data-level="3.6.2" data-path="names-attribute.html"><a href="names-attribute.html#making-an-individual-name-syntactic"><i class="fa fa-check"></i><b>3.6.2</b> Making an individual name syntactic</a></li>
<li class="chapter" data-level="3.6.3" data-path="names-attribute.html"><a href="names-attribute.html#why-universal"><i class="fa fa-check"></i><b>3.6.3</b> Why universal?</a></li>
<li class="chapter" data-level="3.6.4" data-path="names-attribute.html"><a href="names-attribute.html#making-names-universal"><i class="fa fa-check"></i><b>3.6.4</b> Making names universal</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="names-attribute.html"><a href="names-attribute.html#messaging-user-about-name-repair"><i class="fa fa-check"></i><b>3.7</b> Messaging user about name repair</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="call-data-details.html"><a href="call-data-details.html"><i class="fa fa-check"></i><b>4</b> Name details arguments</a>
<ul>
<li class="chapter" data-level="4.1" data-path="call-data-details.html"><a href="call-data-details.html#what-are-data-and-details-arguments"><i class="fa fa-check"></i><b>4.1</b> What are data and details arguments?</a></li>
<li class="chapter" data-level="4.2" data-path="call-data-details.html"><a href="call-data-details.html#whats-the-pattern"><i class="fa fa-check"></i><b>4.2</b> What’s the pattern?</a></li>
<li class="chapter" data-level="4.3" data-path="call-data-details.html"><a href="call-data-details.html#why-is-this-useful"><i class="fa fa-check"></i><b>4.3</b> Why is this useful?</a></li>
<li class="chapter" data-level="4.4" data-path="call-data-details.html"><a href="call-data-details.html#what-are-the-exceptions"><i class="fa fa-check"></i><b>4.4</b> What are the exceptions?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="function-names.html"><a href="function-names.html"><i class="fa fa-check"></i><b>5</b> Function names</a>
<ul>
<li class="chapter" data-level="5.1" data-path="function-names.html"><a href="function-names.html#nouns-vs-verbs"><i class="fa fa-check"></i><b>5.1</b> Nouns vs verbs</a></li>
<li class="chapter" data-level="5.2" data-path="function-names.html"><a href="function-names.html#function-families"><i class="fa fa-check"></i><b>5.2</b> Function families</a></li>
<li class="chapter" data-level="5.3" data-path="function-names.html"><a href="function-names.html#length"><i class="fa fa-check"></i><b>5.3</b> Length</a></li>
<li class="chapter" data-level="5.4" data-path="function-names.html"><a href="function-names.html#conflicts"><i class="fa fa-check"></i><b>5.4</b> Conflicts</a></li>
<li class="chapter" data-level="5.5" data-path="function-names.html"><a href="function-names.html#techniques"><i class="fa fa-check"></i><b>5.5</b> Techniques</a></li>
<li class="chapter" data-level="5.6" data-path="function-names.html"><a href="function-names.html#other-good-advice"><i class="fa fa-check"></i><b>5.6</b> Other good advice</a></li>
</ul></li>
<li class="part"><span><b>II Interface: inputs</b></span></li>
<li class="chapter" data-level="6" data-path="args-hidden.html"><a href="args-hidden.html"><i class="fa fa-check"></i><b>6</b> Avoid hidden arguments</a>
<ul>
<li class="chapter" data-level="6.1" data-path="args-hidden.html"><a href="args-hidden.html#whats-the-problem"><i class="fa fa-check"></i><b>6.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="6.2" data-path="args-hidden.html"><a href="args-hidden.html#what-are-some-examples"><i class="fa fa-check"></i><b>6.2</b> What are some examples?</a></li>
<li class="chapter" data-level="6.3" data-path="args-hidden.html"><a href="args-hidden.html#why-is-it-important"><i class="fa fa-check"></i><b>6.3</b> Why is it important?</a></li>
<li class="chapter" data-level="6.4" data-path="args-hidden.html"><a href="args-hidden.html#how-can-i-remediate-the-problem"><i class="fa fa-check"></i><b>6.4</b> How can I remediate the problem?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="args-data-details.html"><a href="args-data-details.html"><i class="fa fa-check"></i><b>7</b> Data, descriptors, details</a>
<ul>
<li class="chapter" data-level="7.1" data-path="args-data-details.html"><a href="args-data-details.html#whats-the-pattern-1"><i class="fa fa-check"></i><b>7.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="7.2" data-path="args-data-details.html"><a href="args-data-details.html#what-are-some-examples-1"><i class="fa fa-check"></i><b>7.2</b> What are some examples?</a></li>
<li class="chapter" data-level="7.3" data-path="args-data-details.html"><a href="args-data-details.html#why-is-it-important-1"><i class="fa fa-check"></i><b>7.3</b> Why is it important?</a></li>
<li class="chapter" data-level="7.4" data-path="args-data-details.html"><a href="args-data-details.html#how-do-i-avoid-the-problem"><i class="fa fa-check"></i><b>7.4</b> How do I avoid the problem?</a></li>
<li class="chapter" data-level="7.5" data-path="args-data-details.html"><a href="args-data-details.html#how-do-i-remediate-past-mistakes"><i class="fa fa-check"></i><b>7.5</b> How do I remediate past mistakes?</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="args-independence.html"><a href="args-independence.html"><i class="fa fa-check"></i><b>8</b> Avoid dependencies between arguments</a>
<ul>
<li class="chapter" data-level="8.1" data-path="args-independence.html"><a href="args-independence.html#whats-the-problem-1"><i class="fa fa-check"></i><b>8.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="8.2" data-path="args-independence.html"><a href="args-independence.html#what-are-some-examples-2"><i class="fa fa-check"></i><b>8.2</b> What are some examples?</a></li>
<li class="chapter" data-level="8.3" data-path="args-independence.html"><a href="args-independence.html#why-is-this-important"><i class="fa fa-check"></i><b>8.3</b> Why is this important?</a></li>
<li class="chapter" data-level="8.4" data-path="args-independence.html"><a href="args-independence.html#how-do-i-remediate"><i class="fa fa-check"></i><b>8.4</b> How do I remediate?</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="args-independence.html"><a href="args-independence.html#cs-fct-lump"><i class="fa fa-check"></i><b>8.4.1</b> Case study: <code>fct_lump()</code></a></li>
<li class="chapter" data-level="8.4.2" data-path="args-independence.html"><a href="args-independence.html#case-study-grepl-vs-stringrstr_detect"><i class="fa fa-check"></i><b>8.4.2</b> Case study: <code>grepl()</code> vs <code>stringr::str_detect()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case-study-setnames.html"><a href="case-study-setnames.html"><i class="fa fa-check"></i><b>9</b> Case study: <code>setNames()</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="case-study-setnames.html"><a href="case-study-setnames.html#what-does-setnames-do"><i class="fa fa-check"></i><b>9.1</b> What does <code>setNames()</code> do?</a></li>
<li class="chapter" data-level="9.2" data-path="case-study-setnames.html"><a href="case-study-setnames.html#how-can-we-improve-the-names"><i class="fa fa-check"></i><b>9.2</b> How can we improve the names?</a></li>
<li class="chapter" data-level="9.3" data-path="case-study-setnames.html"><a href="case-study-setnames.html#what-about-the-default-values"><i class="fa fa-check"></i><b>9.3</b> What about the default values?</a></li>
<li class="chapter" data-level="9.4" data-path="case-study-setnames.html"><a href="case-study-setnames.html#what-about-bad-inputs"><i class="fa fa-check"></i><b>9.4</b> What about bad inputs?</a></li>
<li class="chapter" data-level="9.5" data-path="case-study-setnames.html"><a href="case-study-setnames.html#how-could-we-extend-this-function"><i class="fa fa-check"></i><b>9.5</b> How could we extend this function?</a></li>
<li class="chapter" data-level="9.6" data-path="case-study-setnames.html"><a href="case-study-setnames.html#compared-to-rlangset_names"><i class="fa fa-check"></i><b>9.6</b> Compared to <code>rlang::set_names()</code></a></li>
</ul></li>
<li class="part"><span><b>III Interface: default values</b></span></li>
<li class="chapter" data-level="10" data-path="def-required.html"><a href="def-required.html"><i class="fa fa-check"></i><b>10</b> Required args shouldn’t have defaults</a>
<ul>
<li class="chapter" data-level="10.1" data-path="def-required.html"><a href="def-required.html#whats-the-problem-2"><i class="fa fa-check"></i><b>10.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="10.2" data-path="def-required.html"><a href="def-required.html#what-are-some-examples-3"><i class="fa fa-check"></i><b>10.2</b> What are some examples?</a></li>
<li class="chapter" data-level="10.3" data-path="def-required.html"><a href="def-required.html#what-are-the-exceptions-1"><i class="fa fa-check"></i><b>10.3</b> What are the exceptions?</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="def-required.html"><a href="def-required.html#args-mutually-exclusive"><i class="fa fa-check"></i><b>10.3.1</b> Pair of mututally exclusive arguments</a></li>
<li class="chapter" data-level="10.3.2" data-path="def-required.html"><a href="def-required.html#args-compound"><i class="fa fa-check"></i><b>10.3.2</b> One compound argument vs multiple simple arguments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cs-rep.html"><a href="cs-rep.html"><i class="fa fa-check"></i><b>11</b> Case study: <code>rep()</code></a>
<ul>
<li class="chapter" data-level="11.1" data-path="cs-rep.html"><a href="cs-rep.html#what-does-rep-do"><i class="fa fa-check"></i><b>11.1</b> What does <code>rep()</code> do?</a></li>
<li class="chapter" data-level="11.2" data-path="cs-rep.html"><a href="cs-rep.html#what-makes-this-function-hard-to-understand"><i class="fa fa-check"></i><b>11.2</b> What makes this function hard to understand?</a></li>
<li class="chapter" data-level="11.3" data-path="cs-rep.html"><a href="cs-rep.html#how-might-we-improve-the-situation"><i class="fa fa-check"></i><b>11.3</b> How might we improve the situation?</a></li>
<li class="chapter" data-level="11.4" data-path="cs-rep.html"><a href="cs-rep.html#dealing-with-bad-inputs"><i class="fa fa-check"></i><b>11.4</b> Dealing with bad inputs</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="def-enum.html"><a href="def-enum.html"><i class="fa fa-check"></i><b>12</b> Enumerate possible options</a>
<ul>
<li class="chapter" data-level="12.1" data-path="def-enum.html"><a href="def-enum.html#whats-the-pattern-2"><i class="fa fa-check"></i><b>12.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="12.2" data-path="def-enum.html"><a href="def-enum.html#what-are-some-examples-4"><i class="fa fa-check"></i><b>12.2</b> What are some examples?</a></li>
<li class="chapter" data-level="12.3" data-path="def-enum.html"><a href="def-enum.html#why-is-it-important-2"><i class="fa fa-check"></i><b>12.3</b> Why is it important?</a></li>
<li class="chapter" data-level="12.4" data-path="def-enum.html"><a href="def-enum.html#how-do-i-use-it"><i class="fa fa-check"></i><b>12.4</b> How do I use it?</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="def-enum.html"><a href="def-enum.html#how-keep-defaults-short"><i class="fa fa-check"></i><b>12.4.1</b> How keep defaults short?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="def-magical.html"><a href="def-magical.html"><i class="fa fa-check"></i><b>13</b> Avoid magical defaults</a>
<ul>
<li class="chapter" data-level="13.1" data-path="def-magical.html"><a href="def-magical.html#whats-the-problem-3"><i class="fa fa-check"></i><b>13.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="13.2" data-path="def-magical.html"><a href="def-magical.html#what-are-some-examples-5"><i class="fa fa-check"></i><b>13.2</b> What are some examples?</a></li>
<li class="chapter" data-level="13.3" data-path="def-magical.html"><a href="def-magical.html#what-are-the-exceptions-2"><i class="fa fa-check"></i><b>13.3</b> What are the exceptions?</a></li>
<li class="chapter" data-level="13.4" data-path="def-magical.html"><a href="def-magical.html#what-causes-the-problem"><i class="fa fa-check"></i><b>13.4</b> What causes the problem?</a></li>
<li class="chapter" data-level="13.5" data-path="def-magical.html"><a href="def-magical.html#how-do-i-remediate-the-problem"><i class="fa fa-check"></i><b>13.5</b> How do I remediate the problem?</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="def-short.html"><a href="def-short.html"><i class="fa fa-check"></i><b>14</b> Keep defaults short and sweet</a>
<ul>
<li class="chapter" data-level="14.1" data-path="def-short.html"><a href="def-short.html#whats-the-pattern-3"><i class="fa fa-check"></i><b>14.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="14.2" data-path="def-short.html"><a href="def-short.html#what-are-some-examples-6"><i class="fa fa-check"></i><b>14.2</b> What are some examples?</a></li>
<li class="chapter" data-level="14.3" data-path="def-short.html"><a href="def-short.html#why-is-it-important-3"><i class="fa fa-check"></i><b>14.3</b> Why is it important?</a></li>
<li class="chapter" data-level="14.4" data-path="def-short.html"><a href="def-short.html#how-do-i-use-it-1"><i class="fa fa-check"></i><b>14.4</b> How do I use it?</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="def-short.html"><a href="def-short.html#arg-short-null"><i class="fa fa-check"></i><b>14.4.1</b> <code>NULL</code> default</a></li>
<li class="chapter" data-level="14.4.2" data-path="def-short.html"><a href="def-short.html#helper-function"><i class="fa fa-check"></i><b>14.4.2</b> Helper function</a></li>
<li class="chapter" data-level="14.4.3" data-path="def-short.html"><a href="def-short.html#args-default-sentinel"><i class="fa fa-check"></i><b>14.4.3</b> Sentinel value</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="def-short.html"><a href="def-short.html#how-do-i-remediate-existing-problems"><i class="fa fa-check"></i><b>14.5</b> How do I remediate existing problems?</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="def-inform.html"><a href="def-inform.html"><i class="fa fa-check"></i><b>15</b> Explain important defaults</a>
<ul>
<li class="chapter" data-level="15.1" data-path="def-inform.html"><a href="def-inform.html#whats-the-pattern-4"><i class="fa fa-check"></i><b>15.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="15.2" data-path="def-inform.html"><a href="def-inform.html#what-are-some-examples-7"><i class="fa fa-check"></i><b>15.2</b> What are some examples?</a></li>
<li class="chapter" data-level="15.3" data-path="def-inform.html"><a href="def-inform.html#why-is-it-important-4"><i class="fa fa-check"></i><b>15.3</b> Why is it important?</a></li>
<li class="chapter" data-level="15.4" data-path="def-inform.html"><a href="def-inform.html#how-can-i-use-it"><i class="fa fa-check"></i><b>15.4</b> How can I use it?</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="def-user.html"><a href="def-user.html"><i class="fa fa-check"></i><b>16</b> User settable defaults</a>
<ul>
<li class="chapter" data-level="16.1" data-path="def-user.html"><a href="def-user.html#whats-the-pattern-5"><i class="fa fa-check"></i><b>16.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="16.2" data-path="def-user.html"><a href="def-user.html#what-are-some-examples-8"><i class="fa fa-check"></i><b>16.2</b> What are some examples?</a></li>
<li class="chapter" data-level="16.3" data-path="def-user.html"><a href="def-user.html#why-is-it-important-5"><i class="fa fa-check"></i><b>16.3</b> Why is it important?</a></li>
<li class="chapter" data-level="16.4" data-path="def-user.html"><a href="def-user.html#what-are-the-exceptions-3"><i class="fa fa-check"></i><b>16.4</b> What are the exceptions?</a></li>
<li class="chapter" data-level="16.5" data-path="def-user.html"><a href="def-user.html#how-do-i-use-it-2"><i class="fa fa-check"></i><b>16.5</b> How do I use it?</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="cs-rgb.html"><a href="cs-rgb.html"><i class="fa fa-check"></i><b>17</b> Case study: <code>rgb()</code></a></li>
<li class="part"><span><b>IV Interface: <code>...</code></b></span></li>
<li class="chapter" data-level="18" data-path="dots-position.html"><a href="dots-position.html"><i class="fa fa-check"></i><b>18</b> Data, dots, details</a>
<ul>
<li class="chapter" data-level="18.1" data-path="dots-position.html"><a href="dots-position.html#whats-the-pattern-6"><i class="fa fa-check"></i><b>18.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="18.2" data-path="dots-position.html"><a href="dots-position.html#what-are-some-examples-9"><i class="fa fa-check"></i><b>18.2</b> What are some examples?</a></li>
<li class="chapter" data-level="18.3" data-path="dots-position.html"><a href="dots-position.html#what-is-it-important"><i class="fa fa-check"></i><b>18.3</b> What is it important?</a></li>
<li class="chapter" data-level="18.4" data-path="dots-position.html"><a href="dots-position.html#how-do-i-do-it"><i class="fa fa-check"></i><b>18.4</b> How do I do it?</a></li>
<li class="chapter" data-level="18.5" data-path="dots-position.html"><a href="dots-position.html#how-do-i-remediate-it"><i class="fa fa-check"></i><b>18.5</b> How do I remediate it?</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="dots-data.html"><a href="dots-data.html"><i class="fa fa-check"></i><b>19</b> Making data with …</a>
<ul>
<li class="chapter" data-level="19.1" data-path="dots-data.html"><a href="dots-data.html#whats-the-problem-4"><i class="fa fa-check"></i><b>19.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="19.2" data-path="dots-data.html"><a href="dots-data.html#what-are-some-examples-10"><i class="fa fa-check"></i><b>19.2</b> What are some examples?</a></li>
<li class="chapter" data-level="19.3" data-path="dots-data.html"><a href="dots-data.html#why-is-it-important-6"><i class="fa fa-check"></i><b>19.3</b> Why is it important?</a></li>
<li class="chapter" data-level="19.4" data-path="dots-data.html"><a href="dots-data.html#what-are-the-exceptions-4"><i class="fa fa-check"></i><b>19.4</b> What are the exceptions?</a></li>
<li class="chapter" data-level="19.5" data-path="dots-data.html"><a href="dots-data.html#how-can-remediate-it"><i class="fa fa-check"></i><b>19.5</b> How can remediate it?</a></li>
<li class="chapter" data-level="19.6" data-path="dots-data.html"><a href="dots-data.html#how-can-i-protect-myself"><i class="fa fa-check"></i><b>19.6</b> How can I protect myself?</a></li>
<li class="chapter" data-level="19.7" data-path="dots-data.html"><a href="dots-data.html#selecting-variables"><i class="fa fa-check"></i><b>19.7</b> Selecting variables</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="dots-prefix.html"><a href="dots-prefix.html"><i class="fa fa-check"></i><b>20</b> Dot prefix</a>
<ul>
<li class="chapter" data-level="20.1" data-path="dots-prefix.html"><a href="dots-prefix.html#whats-the-pattern-7"><i class="fa fa-check"></i><b>20.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="20.2" data-path="dots-prefix.html"><a href="dots-prefix.html#what-are-some-examples-11"><i class="fa fa-check"></i><b>20.2</b> What are some examples?</a></li>
<li class="chapter" data-level="20.3" data-path="dots-prefix.html"><a href="dots-prefix.html#case-study-dplyr-verbs"><i class="fa fa-check"></i><b>20.3</b> Case study: dplyr verbs</a></li>
<li class="chapter" data-level="20.4" data-path="dots-prefix.html"><a href="dots-prefix.html#other-approaches-in-base-r"><i class="fa fa-check"></i><b>20.4</b> Other approaches in base R</a></li>
<li class="chapter" data-level="20.5" data-path="dots-prefix.html"><a href="dots-prefix.html#what-are-the-exceptions-5"><i class="fa fa-check"></i><b>20.5</b> What are the exceptions?</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dots-inspect.html"><a href="dots-inspect.html"><i class="fa fa-check"></i><b>21</b> Inspect the dots</a>
<ul>
<li class="chapter" data-level="21.1" data-path="dots-inspect.html"><a href="dots-inspect.html#whats-the-pattern-8"><i class="fa fa-check"></i><b>21.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="21.2" data-path="dots-inspect.html"><a href="dots-inspect.html#what-are-some-examples-12"><i class="fa fa-check"></i><b>21.2</b> What are some examples?</a></li>
<li class="chapter" data-level="21.3" data-path="dots-inspect.html"><a href="dots-inspect.html#how-do-i-do-it-1"><i class="fa fa-check"></i><b>21.3</b> How do I do it?</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="dots-inspect.html"><a href="dots-inspect.html#what-are-the-limitations"><i class="fa fa-check"></i><b>21.3.1</b> What are the limitations?</a></li>
<li class="chapter" data-level="21.3.2" data-path="dots-inspect.html"><a href="dots-inspect.html#what-are-other-uses"><i class="fa fa-check"></i><b>21.3.2</b> What are other uses?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="cs-mapply-pmap.html"><a href="cs-mapply-pmap.html"><i class="fa fa-check"></i><b>22</b> Case study: <code>mapply()</code> vs <code>pmap()</code></a></li>
<li class="part"><span><b>V Interface: outputs</b></span></li>
<li class="chapter" data-level="23" data-path="out-multi.html"><a href="out-multi.html"><i class="fa fa-check"></i><b>23</b> Returning multiple values</a>
<ul>
<li class="chapter" data-level="23.1" data-path="out-multi.html"><a href="out-multi.html#different-sizes"><i class="fa fa-check"></i><b>23.1</b> Different sizes</a></li>
<li class="chapter" data-level="23.2" data-path="out-multi.html"><a href="out-multi.html#same-size"><i class="fa fa-check"></i><b>23.2</b> Same size</a></li>
<li class="chapter" data-level="23.3" data-path="out-multi.html"><a href="out-multi.html#case-study-str_locate"><i class="fa fa-check"></i><b>23.3</b> Case study: <code>str_locate()</code></a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="out-type-stability.html"><a href="out-type-stability.html"><i class="fa fa-check"></i><b>24</b> Type-stability</a>
<ul>
<li class="chapter" data-level="24.1" data-path="out-type-stability.html"><a href="out-type-stability.html#simple-examples"><i class="fa fa-check"></i><b>24.1</b> Simple examples</a></li>
<li class="chapter" data-level="24.2" data-path="out-type-stability.html"><a href="out-type-stability.html#more-complicated-examples"><i class="fa fa-check"></i><b>24.2</b> More complicated examples</a></li>
<li class="chapter" data-level="24.3" data-path="out-type-stability.html"><a href="out-type-stability.html#challenge-the-median"><i class="fa fa-check"></i><b>24.3</b> Challenge: the median</a></li>
<li class="chapter" data-level="24.4" data-path="out-type-stability.html"><a href="out-type-stability.html#exercises"><i class="fa fa-check"></i><b>24.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="out-vectorisation.html"><a href="out-vectorisation.html"><i class="fa fa-check"></i><b>25</b> Vectorisation</a></li>
<li class="chapter" data-level="26" data-path="out-invisible.html"><a href="out-invisible.html"><i class="fa fa-check"></i><b>26</b> Side-effect functions should return invisibly</a>
<ul>
<li class="chapter" data-level="26.1" data-path="out-invisible.html"><a href="out-invisible.html#whats-the-pattern-9"><i class="fa fa-check"></i><b>26.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="26.2" data-path="out-invisible.html"><a href="out-invisible.html#what-are-some-examples-13"><i class="fa fa-check"></i><b>26.2</b> What are some examples?</a></li>
<li class="chapter" data-level="26.3" data-path="out-invisible.html"><a href="out-invisible.html#why-is-it-important-7"><i class="fa fa-check"></i><b>26.3</b> Why is it important?</a></li>
</ul></li>
<li class="part"><span><b>VI Interface: errors</b></span></li>
<li class="chapter" data-level="27" data-path="err-call.html"><a href="err-call.html"><i class="fa fa-check"></i><b>27</b> Error call</a></li>
<li class="chapter" data-level="28" data-path="err-constructor.html"><a href="err-constructor.html"><i class="fa fa-check"></i><b>28</b> Error constructors</a>
<ul>
<li class="chapter" data-level="28.1" data-path="err-constructor.html"><a href="err-constructor.html#whats-the-pattern-10"><i class="fa fa-check"></i><b>28.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="28.2" data-path="err-constructor.html"><a href="err-constructor.html#why-is-this-important-1"><i class="fa fa-check"></i><b>28.2</b> Why is this important?</a></li>
<li class="chapter" data-level="28.3" data-path="err-constructor.html"><a href="err-constructor.html#what-does-an-error-constructor-do"><i class="fa fa-check"></i><b>28.3</b> What does an error constructor do?</a></li>
<li class="chapter" data-level="28.4" data-path="err-constructor.html"><a href="err-constructor.html#how-do-i-test"><i class="fa fa-check"></i><b>28.4</b> How do I test?</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="err-constructor.html"><a href="err-constructor.html#test-the-constructor"><i class="fa fa-check"></i><b>28.4.1</b> Test the constructor</a></li>
<li class="chapter" data-level="28.4.2" data-path="err-constructor.html"><a href="err-constructor.html#test-usage"><i class="fa fa-check"></i><b>28.4.2</b> Test usage</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="err-constructor.html"><a href="err-constructor.html#error-hierarchies"><i class="fa fa-check"></i><b>28.5</b> Error hierarchies</a></li>
</ul></li>
<li class="part"><span><b>VII Interface: changes</b></span></li>
<li class="chapter" data-level="29" data-path="changes-multivers.html"><a href="changes-multivers.html"><i class="fa fa-check"></i><b>29</b> Work with multiple dependency versions</a>
<ul>
<li class="chapter" data-level="29.1" data-path="changes-multivers.html"><a href="changes-multivers.html#whats-the-pattern-11"><i class="fa fa-check"></i><b>29.1</b> What’s the pattern?</a></li>
<li class="chapter" data-level="29.2" data-path="changes-multivers.html"><a href="changes-multivers.html#writing-code"><i class="fa fa-check"></i><b>29.2</b> Writing code</a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="changes-multivers.html"><a href="changes-multivers.html#case-study-tidyr"><i class="fa fa-check"></i><b>29.2.1</b> Case study: tidyr</a></li>
</ul></li>
<li class="chapter" data-level="29.3" data-path="changes-multivers.html"><a href="changes-multivers.html#testing-with-multiple-package-versions"><i class="fa fa-check"></i><b>29.3</b> Testing with multiple package versions</a></li>
<li class="chapter" data-level="29.4" data-path="changes-multivers.html"><a href="changes-multivers.html#using-only-the-new-version"><i class="fa fa-check"></i><b>29.4</b> Using only the new version</a></li>
</ul></li>
<li class="part"><span><b>VIII Interface: side effects</b></span></li>
<li class="chapter" data-level="30" data-path="side-effect-soup.html"><a href="side-effect-soup.html"><i class="fa fa-check"></i><b>30</b> Side-effect soup</a>
<ul>
<li class="chapter" data-level="30.1" data-path="side-effect-soup.html"><a href="side-effect-soup.html#what-is-a-side-effect"><i class="fa fa-check"></i><b>30.1</b> What is a side-effect?</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="side-effect-soup.html"><a href="side-effect-soup.html#user-feedback"><i class="fa fa-check"></i><b>30.1.1</b> User feedback</a></li>
<li class="chapter" data-level="30.1.2" data-path="side-effect-soup.html"><a href="side-effect-soup.html#global-state"><i class="fa fa-check"></i><b>30.1.2</b> Global state</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="side-effect-soup.html"><a href="side-effect-soup.html#what-are-some-examples-14"><i class="fa fa-check"></i><b>30.2</b> What are some examples?</a></li>
<li class="chapter" data-level="30.3" data-path="side-effect-soup.html"><a href="side-effect-soup.html#why-is-it-bad"><i class="fa fa-check"></i><b>30.3</b> Why is it bad?</a></li>
<li class="chapter" data-level="30.4" data-path="side-effect-soup.html"><a href="side-effect-soup.html#how-avoid-it"><i class="fa fa-check"></i><b>30.4</b> How avoid it?</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="side-effect-soup.html"><a href="side-effect-soup.html#localise-side-effects"><i class="fa fa-check"></i><b>30.4.1</b> Localise side-effects</a></li>
<li class="chapter" data-level="30.4.2" data-path="side-effect-soup.html"><a href="side-effect-soup.html#extract-side-effects"><i class="fa fa-check"></i><b>30.4.2</b> Extract side-effects</a></li>
<li class="chapter" data-level="30.4.3" data-path="side-effect-soup.html"><a href="side-effect-soup.html#make-side-effects-noisy"><i class="fa fa-check"></i><b>30.4.3</b> Make side-effects noisy</a></li>
<li class="chapter" data-level="30.4.4" data-path="side-effect-soup.html"><a href="side-effect-soup.html#provide-an-argument-to-suppress"><i class="fa fa-check"></i><b>30.4.4</b> Provide an argument to suppress</a></li>
<li class="chapter" data-level="30.4.5" data-path="side-effect-soup.html"><a href="side-effect-soup.html#use-the-print-method"><i class="fa fa-check"></i><b>30.4.5</b> Use the <code>print()</code> method</a></li>
<li class="chapter" data-level="30.4.6" data-path="side-effect-soup.html"><a href="side-effect-soup.html#make-easy-to-undo"><i class="fa fa-check"></i><b>30.4.6</b> Make easy to undo</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="side-effect-soup.html"><a href="side-effect-soup.html#package-considerations"><i class="fa fa-check"></i><b>30.5</b> Package considerations</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="spooky-action.html"><a href="spooky-action.html"><i class="fa fa-check"></i><b>31</b> Spooky action</a>
<ul>
<li class="chapter" data-level="31.1" data-path="spooky-action.html"><a href="spooky-action.html#whats-the-problem-5"><i class="fa fa-check"></i><b>31.1</b> What’s the problem?</a></li>
<li class="chapter" data-level="31.2" data-path="spooky-action.html"><a href="spooky-action.html#what-precisely-is-a-spooky-action"><i class="fa fa-check"></i><b>31.2</b> What precisely is a spooky action?</a></li>
<li class="chapter" data-level="31.3" data-path="spooky-action.html"><a href="spooky-action.html#how-can-i-remediate-spooky-actions"><i class="fa fa-check"></i><b>31.3</b> How can I remediate spooky actions?</a>
<ul>
<li class="chapter" data-level="31.3.1" data-path="spooky-action.html"><a href="spooky-action.html#parameterise-the-action"><i class="fa fa-check"></i><b>31.3.1</b> Parameterise the action</a></li>
<li class="chapter" data-level="31.3.2" data-path="spooky-action.html"><a href="spooky-action.html#advertise-the-action-with-a-clear-name"><i class="fa fa-check"></i><b>31.3.2</b> Advertise the action with a clear name</a></li>
<li class="chapter" data-level="31.3.3" data-path="spooky-action.html"><a href="spooky-action.html#ask-for-confirmation"><i class="fa fa-check"></i><b>31.3.3</b> Ask for confirmation</a></li>
<li class="chapter" data-level="31.3.4" data-path="spooky-action.html"><a href="spooky-action.html#advertise-the-side-effects"><i class="fa fa-check"></i><b>31.3.4</b> Advertise the side-effects</a></li>
</ul></li>
<li class="chapter" data-level="31.4" data-path="spooky-action.html"><a href="spooky-action.html#case-studies"><i class="fa fa-check"></i><b>31.4</b> Case studies</a>
<ul>
<li class="chapter" data-level="31.4.1" data-path="spooky-action.html"><a href="spooky-action.html#save-and-load"><i class="fa fa-check"></i><b>31.4.1</b> <code>save()</code> and <code>load()</code></a></li>
<li class="chapter" data-level="31.4.2" data-path="spooky-action.html"><a href="spooky-action.html#usethis"><i class="fa fa-check"></i><b>31.4.2</b> usethis</a></li>
<li class="chapter" data-level="31.4.3" data-path="spooky-action.html"><a href="spooky-action.html#section"><i class="fa fa-check"></i><b>31.4.3</b> <code>&lt;&lt;-</code></a></li>
<li class="chapter" data-level="31.4.4" data-path="spooky-action.html"><a href="spooky-action.html#assign-in-a-for-loop"><i class="fa fa-check"></i><b>31.4.4</b> <code>assign()</code> in a for loop</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i><b>A</b> Glossary</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tidyverse design guide</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="case-study-setnames" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Case study: <code>setNames()</code><a href="case-study-setnames.html#case-study-setnames" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="what-does-setnames-do" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> What does <code>setNames()</code> do?<a href="case-study-setnames.html#what-does-setnames-do" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>stats::setNames()</code> is a shorthand that allows you to set vector names inline (it’s a little surprising that it lives in the stats package). It has a simple definition:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="case-study-setnames.html#cb32-1" aria-hidden="true" tabindex="-1"></a>setNames <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">object =</span> nm, nm) {</span>
<span id="cb32-2"><a href="case-study-setnames.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(object) <span class="ot">&lt;-</span> nm</span>
<span id="cb32-3"><a href="case-study-setnames.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  object</span>
<span id="cb32-4"><a href="case-study-setnames.html#cb32-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And is easy to use:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="case-study-setnames.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instead of</span></span>
<span id="cb33-2"><a href="case-study-setnames.html#cb33-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb33-3"><a href="case-study-setnames.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</span>
<span id="cb33-4"><a href="case-study-setnames.html#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="case-study-setnames.html#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Can write</span></span>
<span id="cb33-6"><a href="case-study-setnames.html#cb33-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</span>
<span id="cb33-7"><a href="case-study-setnames.html#cb33-7" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb33-8"><a href="case-study-setnames.html#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; a b c </span></span>
<span id="cb33-9"><a href="case-study-setnames.html#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 2 3</span></span></code></pre></div>
<p>This function is short (just two lines of code!) but yields a surprisingly rich analysis.</p>
</div>
<div id="how-can-we-improve-the-names" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> How can we improve the names?<a href="case-study-setnames.html#how-can-we-improve-the-names" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Firstly, I prefer snake_case to camelCase, so I’d call the function <code>set_names()</code>. Then we need to consider the arguments:</p>
<ul>
<li><p>I think the first argument, <code>object</code>, would be better called <code>x</code> in order
to emphasise that this function only works with vectors (because only
vectors have names).</p></li>
<li><p>The second argument, <code>nm</code> is rather terse, and I don’t see any disadvantage
in calling it <code>names</code>. I think you could also argue that it should be
called <code>y</code> since its meaning should be obvious from the function name.</p></li>
</ul>
<p>This yields:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="case-study-setnames.html#cb34-1" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> names, names) {</span>
<span id="cb34-2"><a href="case-study-setnames.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(x) <span class="ot">&lt;-</span> names</span>
<span id="cb34-3"><a href="case-study-setnames.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb34-4"><a href="case-study-setnames.html#cb34-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="what-about-the-default-values" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> What about the default values?<a href="case-study-setnames.html#what-about-the-default-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The default values of <code>setNames()</code> are a little hard to understand, because the default value of the first argument is the second argument. It was defined this way to make it possible to name a character vector with itself:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="case-study-setnames.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(<span class="at">nm =</span> <span class="fu">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;cake&quot;</span>))</span>
<span id="cb35-2"><a href="case-study-setnames.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    apple   banana     cake </span></span>
<span id="cb35-3"><a href="case-study-setnames.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  &quot;apple&quot; &quot;banana&quot;   &quot;cake&quot;</span></span></code></pre></div>
<p>But that decision leads to a function signature that violates one of the principles of Chapter <a href="args-data-details.html#args-data-details">7</a>: a required argument comes after an optional argument. Fortunately, we can fix this easily and still preserve the useful ability to name a vector with itself:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="case-study-setnames.html#cb36-1" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">names =</span> x) {</span>
<span id="cb36-2"><a href="case-study-setnames.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(x) <span class="ot">&lt;-</span> names</span>
<span id="cb36-3"><a href="case-study-setnames.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb36-4"><a href="case-study-setnames.html#cb36-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-5"><a href="case-study-setnames.html#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="case-study-setnames.html#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;cake&quot;</span>))</span>
<span id="cb36-7"><a href="case-study-setnames.html#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    apple   banana     cake </span></span>
<span id="cb36-8"><a href="case-study-setnames.html#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  &quot;apple&quot; &quot;banana&quot;   &quot;cake&quot;</span></span></code></pre></div>
<p>This helps to emphasise that <code>x</code> is the primary argument.</p>
</div>
<div id="what-about-bad-inputs" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> What about bad inputs?<a href="case-study-setnames.html#what-about-bad-inputs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we’ve considered how the function works with correct inputs, it’s time to consider how it should work with malformed inputs. The current function checks neither the length not the type:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="case-study-setnames.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb37-2"><a href="case-study-setnames.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    a &lt;NA&gt; &lt;NA&gt; </span></span>
<span id="cb37-3"><a href="case-study-setnames.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1    2    3</span></span>
<span id="cb37-4"><a href="case-study-setnames.html#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="case-study-setnames.html#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">list</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], letters[<span class="dv">4</span>], letters[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))</span>
<span id="cb37-6"><a href="case-study-setnames.html#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)                d      c(&quot;e&quot;, &quot;f&quot;) </span></span>
<span id="cb37-7"><a href="case-study-setnames.html#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                1                2                3</span></span></code></pre></div>
<p>We can resolve this by asserting that the names should always be a character vector, and should have the same length as <code>x</code>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="case-study-setnames.html#cb38-1" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">names =</span> x) {</span>
<span id="cb38-2"><a href="case-study-setnames.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.character</span>(names) <span class="sc">||</span> <span class="fu">length</span>(names) <span class="sc">!=</span> <span class="fu">length</span>(x)) {</span>
<span id="cb38-3"><a href="case-study-setnames.html#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;`names` must be a character vector the same length as `x`.&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-4"><a href="case-study-setnames.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-5"><a href="case-study-setnames.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-6"><a href="case-study-setnames.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(x) <span class="ot">&lt;-</span> names</span>
<span id="cb38-7"><a href="case-study-setnames.html#cb38-7" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb38-8"><a href="case-study-setnames.html#cb38-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-9"><a href="case-study-setnames.html#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="case-study-setnames.html#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">&quot;a&quot;</span>)</span>
<span id="cb38-11"><a href="case-study-setnames.html#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: `names` must be a character vector the same length as `x`.</span></span>
<span id="cb38-12"><a href="case-study-setnames.html#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">list</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], letters[<span class="dv">4</span>], letters[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>]))</span>
<span id="cb38-13"><a href="case-study-setnames.html#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: `names` must be a character vector the same length as `x`.</span></span></code></pre></div>
<p>You could also frame this test using vctrs assertions:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="case-study-setnames.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vctrs)</span>
<span id="cb39-2"><a href="case-study-setnames.html#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="case-study-setnames.html#cb39-3" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">names =</span> x) {</span>
<span id="cb39-4"><a href="case-study-setnames.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vec_assert</span>(x)</span>
<span id="cb39-5"><a href="case-study-setnames.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vec_assert</span>(names, <span class="at">ptype =</span> <span class="fu">character</span>(), <span class="at">size =</span> <span class="fu">length</span>(x))</span>
<span id="cb39-6"><a href="case-study-setnames.html#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="case-study-setnames.html#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(x) <span class="ot">&lt;-</span> names</span>
<span id="cb39-8"><a href="case-study-setnames.html#cb39-8" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb39-9"><a href="case-study-setnames.html#cb39-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Note that I slipped in an assertion that <code>x</code> should be a vector. This slightly improves the error message if you accidentally supply the wrong sort of input to <code>set_names()</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="case-study-setnames.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(mean, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb40-2"><a href="case-study-setnames.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in names(object) &lt;- nm: names() applied to a non-vector</span></span>
<span id="cb40-3"><a href="case-study-setnames.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(mean, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb40-4"><a href="case-study-setnames.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in `set_names()`:</span></span>
<span id="cb40-5"><a href="case-study-setnames.html#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ! `x` must be a vector, not a function.</span></span></code></pre></div>
<p>Note that we’re simply checking the length of <code>names</code> here, rather than recycling it, i.e. the invariant is <code>vec_size(set_names(x, y))</code> is <code>vec_size(x)</code>, not <code>vec_size_common(x, y)</code>. I think this is the correct behaviour because you usually add names to a vector to create a lookup table, and a lookup table is not useful if there are duplicated names. This makes <code>set_names()</code> less general in return for better error messages when you do something suspicious (and you can always use an explicit <code>rep_along()</code> if do want this behaviour.)</p>
</div>
<div id="how-could-we-extend-this-function" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> How could we extend this function?<a href="case-study-setnames.html#how-could-we-extend-this-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we’ve modified the function so it doesn’t violate the principles in this book, we can think about how we might extend it. Currently the function is only useful for setting names to a constant. Maybe we could extend it to also make it easier to change existing names? One way to do that would be to allow <code>names</code> to be a function:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="case-study-setnames.html#cb41-1" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">names =</span> x) {</span>
<span id="cb41-2"><a href="case-study-setnames.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vec_assert</span>(x)</span>
<span id="cb41-3"><a href="case-study-setnames.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-4"><a href="case-study-setnames.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.function</span>(names)) {</span>
<span id="cb41-5"><a href="case-study-setnames.html#cb41-5" aria-hidden="true" tabindex="-1"></a>    names <span class="ot">&lt;-</span> <span class="fu">names</span>(base<span class="sc">::</span><span class="fu">names</span>(x))</span>
<span id="cb41-6"><a href="case-study-setnames.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-7"><a href="case-study-setnames.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vec_assert</span>(names, <span class="at">ptype =</span> <span class="fu">character</span>(), <span class="at">size =</span> <span class="fu">length</span>(x))</span>
<span id="cb41-8"><a href="case-study-setnames.html#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="case-study-setnames.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(x) <span class="ot">&lt;-</span> names</span>
<span id="cb41-10"><a href="case-study-setnames.html#cb41-10" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb41-11"><a href="case-study-setnames.html#cb41-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-12"><a href="case-study-setnames.html#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="case-study-setnames.html#cb41-13" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb41-14"><a href="case-study-setnames.html#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(x, toupper)</span>
<span id="cb41-15"><a href="case-study-setnames.html#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; A B C </span></span>
<span id="cb41-16"><a href="case-study-setnames.html#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 2 3</span></span></code></pre></div>
<p>We could also support anonymous function formula shortcut used in many places in the tidyverse.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="case-study-setnames.html#cb42-1" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">names =</span> x) {</span>
<span id="cb42-2"><a href="case-study-setnames.html#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vec_assert</span>(x)</span>
<span id="cb42-3"><a href="case-study-setnames.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-4"><a href="case-study-setnames.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.function</span>(names) <span class="sc">||</span> rlang<span class="sc">::</span><span class="fu">is_formula</span>(names)) {</span>
<span id="cb42-5"><a href="case-study-setnames.html#cb42-5" aria-hidden="true" tabindex="-1"></a>    fun <span class="ot">&lt;-</span> rlang<span class="sc">::</span><span class="fu">as_function</span>(names)</span>
<span id="cb42-6"><a href="case-study-setnames.html#cb42-6" aria-hidden="true" tabindex="-1"></a>    names <span class="ot">&lt;-</span> <span class="fu">fun</span>(base<span class="sc">::</span><span class="fu">names</span>(x))</span>
<span id="cb42-7"><a href="case-study-setnames.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-8"><a href="case-study-setnames.html#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vec_assert</span>(names, <span class="at">ptype =</span> <span class="fu">character</span>(), <span class="at">size =</span> <span class="fu">length</span>(x))</span>
<span id="cb42-9"><a href="case-study-setnames.html#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="case-study-setnames.html#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(x) <span class="ot">&lt;-</span> names</span>
<span id="cb42-11"><a href="case-study-setnames.html#cb42-11" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb42-12"><a href="case-study-setnames.html#cb42-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-13"><a href="case-study-setnames.html#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="case-study-setnames.html#cb42-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb42-15"><a href="case-study-setnames.html#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(x, <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">&quot;x-&quot;</span>, .))</span>
<span id="cb42-16"><a href="case-study-setnames.html#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x-a x-b x-c </span></span>
<span id="cb42-17"><a href="case-study-setnames.html#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1   2   3</span></span></code></pre></div>
<p>Now <code>set_names()</code> supports overriding and modifying names. What about removing them? It turns out that <code>setNames()</code> supported this, but our stricter checks prohibit:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="case-study-setnames.html#cb43-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb43-2"><a href="case-study-setnames.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(x, <span class="cn">NULL</span>)</span>
<span id="cb43-3"><a href="case-study-setnames.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3</span></span>
<span id="cb43-4"><a href="case-study-setnames.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(x, <span class="cn">NULL</span>)</span>
<span id="cb43-5"><a href="case-study-setnames.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error in `set_names()`:</span></span>
<span id="cb43-6"><a href="case-study-setnames.html#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ! `names` must be a vector, not NULL.</span></span></code></pre></div>
<p>We can fix this with another clause:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="case-study-setnames.html#cb44-1" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">names =</span> x) {</span>
<span id="cb44-2"><a href="case-study-setnames.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vec_assert</span>(x)</span>
<span id="cb44-3"><a href="case-study-setnames.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-4"><a href="case-study-setnames.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(names)) {</span>
<span id="cb44-5"><a href="case-study-setnames.html#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.function</span>(names) <span class="sc">||</span> rlang<span class="sc">::</span><span class="fu">is_formula</span>(names)) {</span>
<span id="cb44-6"><a href="case-study-setnames.html#cb44-6" aria-hidden="true" tabindex="-1"></a>      fun <span class="ot">&lt;-</span> rlang<span class="sc">::</span><span class="fu">as_function</span>(names)</span>
<span id="cb44-7"><a href="case-study-setnames.html#cb44-7" aria-hidden="true" tabindex="-1"></a>      names <span class="ot">&lt;-</span> <span class="fu">fun</span>(base<span class="sc">::</span><span class="fu">names</span>(x))</span>
<span id="cb44-8"><a href="case-study-setnames.html#cb44-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb44-9"><a href="case-study-setnames.html#cb44-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-10"><a href="case-study-setnames.html#cb44-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-11"><a href="case-study-setnames.html#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="case-study-setnames.html#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(x) <span class="ot">&lt;-</span> names</span>
<span id="cb44-13"><a href="case-study-setnames.html#cb44-13" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb44-14"><a href="case-study-setnames.html#cb44-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-15"><a href="case-study-setnames.html#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="case-study-setnames.html#cb44-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">c =</span> <span class="dv">3</span>)</span>
<span id="cb44-17"><a href="case-study-setnames.html#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set_names</span>(x, <span class="cn">NULL</span>)</span>
<span id="cb44-18"><a href="case-study-setnames.html#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3</span></span></code></pre></div>
<p>However, I think this has muddied the logic. To resolve it, I think we should pull out the checking code into a separate function. After trying out a <a href="https://github.com/tidyverse/principles/issues/79">few approaches</a>, I ended up with:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="case-study-setnames.html#cb45-1" aria-hidden="true" tabindex="-1"></a>check_names <span class="ot">&lt;-</span> <span class="cf">function</span>(names, x) {</span>
<span id="cb45-2"><a href="case-study-setnames.html#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(names)) {</span>
<span id="cb45-3"><a href="case-study-setnames.html#cb45-3" aria-hidden="true" tabindex="-1"></a>    names</span>
<span id="cb45-4"><a href="case-study-setnames.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">vec_is</span>(names)) {</span>
<span id="cb45-5"><a href="case-study-setnames.html#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vec_assert</span>(names, <span class="at">ptype =</span> <span class="fu">character</span>(), <span class="at">size =</span> <span class="fu">length</span>(x))  </span>
<span id="cb45-6"><a href="case-study-setnames.html#cb45-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.function</span>(names)) {</span>
<span id="cb45-7"><a href="case-study-setnames.html#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">check_names_2</span>(<span class="fu">names</span>(base<span class="sc">::</span><span class="fu">names</span>(x)), x)</span>
<span id="cb45-8"><a href="case-study-setnames.html#cb45-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (rlang<span class="sc">::</span><span class="fu">is.formula</span>(names)) {</span>
<span id="cb45-9"><a href="case-study-setnames.html#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">check_names_2</span>(rlang<span class="sc">::</span><span class="fu">as_function</span>(names), x)</span>
<span id="cb45-10"><a href="case-study-setnames.html#cb45-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb45-11"><a href="case-study-setnames.html#cb45-11" aria-hidden="true" tabindex="-1"></a>    rlang<span class="sc">::</span><span class="fu">abort</span>(<span class="st">&quot;`names` must be NULL, a function or formula, or a vector&quot;</span>)</span>
<span id="cb45-12"><a href="case-study-setnames.html#cb45-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-13"><a href="case-study-setnames.html#cb45-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This then replaces <code>vec_assert()</code> in <code>set_names()</code>. I separate the input checking and implementation with a blank line to help visually group the parts of the function.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="case-study-setnames.html#cb46-1" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">names =</span> x) {</span>
<span id="cb46-2"><a href="case-study-setnames.html#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vec_assert</span>(x)</span>
<span id="cb46-3"><a href="case-study-setnames.html#cb46-3" aria-hidden="true" tabindex="-1"></a>  names <span class="ot">&lt;-</span> <span class="fu">check_names</span>(names, x)</span>
<span id="cb46-4"><a href="case-study-setnames.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-5"><a href="case-study-setnames.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(x) <span class="ot">&lt;-</span> names</span>
<span id="cb46-6"><a href="case-study-setnames.html#cb46-6" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb46-7"><a href="case-study-setnames.html#cb46-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We <em>could</em> simplify the function even further, but I think this is a bad idea becaues it mingles input validation with implementation:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="case-study-setnames.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Don&#39;t do this</span></span>
<span id="cb47-2"><a href="case-study-setnames.html#cb47-2" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">names =</span> x) {</span>
<span id="cb47-3"><a href="case-study-setnames.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vec_assert</span>(x)</span>
<span id="cb47-4"><a href="case-study-setnames.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(x) <span class="ot">&lt;-</span> <span class="fu">check_names</span>(names, x)</span>
<span id="cb47-5"><a href="case-study-setnames.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb47-6"><a href="case-study-setnames.html#cb47-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-7"><a href="case-study-setnames.html#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="case-study-setnames.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Or even</span></span>
<span id="cb47-9"><a href="case-study-setnames.html#cb47-9" aria-hidden="true" tabindex="-1"></a>set_names <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">names =</span> x) {</span>
<span id="cb47-10"><a href="case-study-setnames.html#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">names&lt;-</span><span class="st">`</span>(<span class="fu">vec_assert</span>(x), <span class="fu">check_names</span>(names, x))</span>
<span id="cb47-11"><a href="case-study-setnames.html#cb47-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="compared-to-rlangset_names" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Compared to <code>rlang::set_names()</code><a href="case-study-setnames.html#compared-to-rlangset_names" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you’re familiar with rlang, you might notice that we’ve ended up with something rather similar to <code>rlang::set_names()</code>. However, these careful analysis in this chapter has lead to a few differences. <code>rlang::set_names()</code>:</p>
<ul>
<li><p>Calls the second argument <code>nm</code>, instead of something more descriptive.
I think this is simply because we never sat down and fully considered the
interface.</p></li>
<li><p>Coerces <code>nm</code> to character vector. This allows <code>rlang::set_names(1:4)</code> to
automatically name the vector, but this seems a relatively weak new feature
in return for the cost of not throwing an error message if you provide an
unsual vector type. (Both lists and data frames have <code>as.character()</code> methods
so this will work for basically any type of vector, even if completely
inappropriate.)</p></li>
<li><p>Passes <code>...</code> on to function <code>nm</code>. I now think that decision was a
mistake: it substantially complicates the interface in return for a
relatively small investment.</p></li>
</ul>

</div>
</div>



</div>
            </section>

          </div>
        </div>
      </div>
<a href="args-independence.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="def-required.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tidyverse/principles/edit/master/cs-setNames.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
